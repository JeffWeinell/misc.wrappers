head(ages.df.pars3)
head(ages.df)
colnames(ages.df.pars3[,c(1:4,9:11)])
ages.df2 <- ages.df[c("clade","crown.node","stem.node","crown.age.mean","crown.age.CI.lower","crown.age.CI.upper","event.order"),]
head(ages.df2)
ages.df2 <- ages.df[,c("clade","crown.node","stem.node","crown.age.mean","crown.age.CI.lower","crown.age.CI.upper","event.order")]
head(ages.df2)
crown.df <- ages.df[,c("clade","crown.node","stem.node","crown.age.mean","crown.age.CI.lower","crown.age.CI.upper","event.order")]
colnames(ages.df.pars3[,c(1:3,5,7:8,11)])
colnames(ages.df.pars3[,c(1:3,6,7,10,11)])
midpoint.df <- ages.df[,c("clade","crown.node","stem.node","branch.age.midpoint","stem.age.CI.lower","crown.age.CI.upper","event.order")]
stem.df  <- ages.df[,c("clade","crown.node","stem.node","stem.age.mean","stem.age.CI.lower","stem.age.CI.upper","event.order")]
stem.df
midpoint.df
crown.df[,'type']    <- 'crown'#
stem.df[,'type']     <- 'stem'#
midpoint.df[,'type'] <- 'midpoint'#
midpoint.df[,'event.order'] <- midpoint.df[,'event.order'] + 0.25#
colnames(crown.df) <- colnames(stem.df) <- colnames(midpoint.df) <- c('clade','crown.node','stem.node','age','CI.lower','CI.upper','event.order','type')
ages.df2 <- rbind(crown.df,stem.df,midpoint.df)#
plot1 <- ggplot(data=ages.df2, mapping=aes(x=age,y=event.order, color = type)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
plot1
ages.df <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})
crown.nodes.tips <- lapply(ages.df[order(ages.df[,'event.order']),'crown.node'],function(x){timetree2@phylo$tip.label[unlist(phangorn::Descendants(timetree2@phylo,node=x))]})
ages.df[,'event.order']
ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)
head(ages.df)
crown.nodes.tips <- lapply(ages.df[order(ages.df[,'event.order']),'crown.node'],function(x){timetree2@phylo$tip.label[unlist(phangorn::Descendants(timetree2@phylo,node=x))]})
crown.nodes.tips
crown.df <- ages.df[,c("clade","crown.node","stem.node","crown.age.mean","crown.age.CI.lower","crown.age.CI.upper","event.order")]#
stem.df  <- ages.df[,c("clade","crown.node","stem.node","stem.age.mean","stem.age.CI.lower","stem.age.CI.upper","event.order")]
midpoint.df <- ages.df[,c("clade","crown.node","stem.node","branch.age.midpoint","stem.age.CI.lower","crown.age.CI.upper","event.order")]#
crown.df[,'type']    <- 'crown'#
stem.df[,'type']     <- 'stem'#
midpoint.df[,'type'] <- 'midpoint'#
midpoint.df[,'event.order'] <- midpoint.df[,'event.order'] + 0.25
colnames(crown.df) <- colnames(stem.df) <- colnames(midpoint.df) <- c('clade','crown.node','stem.node','age','CI.lower','CI.upper','event.order','type')#
ages.df2 <- rbind(crown.df,stem.df,midpoint.df)
ages.df2
ages.df2 <- rbind(crown.df,stem.df,midpoint.df)#
plot1 <- ggplot(data=ages.df2, mapping=aes(x=age,y=event.order, color = type)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
plot1
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point(color=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point(aes(color=c('red','blue','black'))) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse() + scale_color_discrete(color=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse() + scale_color_discrete(colors=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse() + scale_color_manual(values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse() + scale_color_manual("type",values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_color_manual("type",values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_color_manual(type,breaks=c("crown","stem","midpoint"),values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_color_manual(aes('type',breaks=c("crown","stem","midpoint"),values=c('red','blue','black')))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_color_manual(ages.df2[,'type'],breaks=c("crown","stem","midpoint"),values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point() + scale_fill_manual(ages.df2[,'type'],breaks=c("crown","stem","midpoint"),values=c('red','blue','black'))
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=factor(type))) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual(values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual(values=c('red','blue','black')) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual(values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_fill_manual(values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order)) + geom_point(fill=factor(type)) + scale_fill_manual(,values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() # + scale_fill_manual(,values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() # + scale_fill_manual(,values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black")) # + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color='black') + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,fill=type)) + geom_point() + scale_color_manual("type",breaks=c("crown","stem","midpoint"),values=c('red','blue','black')) + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.1, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black",linewidth=0.5) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black",linesize=0.5) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black",size=0.5) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black",size=1) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4, color="black",size=0.1) + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("red","blue","black"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse() + xlab("clade #")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse() + ylab("clade #")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse() + ylab("clade age rank") + xlab("clade age Ma")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + scale_x_reverse() + ylab("clade age rank (oldest to youngest)") + xlab("clade age Ma")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + coord_flip() + ylab("clade age rank (oldest to youngest)") + xlab("clade age Ma")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + ylab("clade age rank (oldest to youngest)") + xlab("clade age Ma")
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + ylab("clade age rank (oldest to youngest)") + xlab("clade age Ma") + scale_x_reverse()
ggplot(data=ages.df2, mapping=aes(x=age,y=event.order,color=type)) + geom_point() + scale_color_manual(,values=c("blue","black","red"))  + geom_errorbar(aes(age, event.order, xmin = CI.lower, xmax = CI.upper), width = 0.4,size=0.25, color="black") + theme_classic() + ylab("clade age rank (oldest to youngest)") + xlab("clade age Ma") + scale_x_reverse() + coord_flip()
crown.nodes.tips
timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444"))
tips.df <- data.frame(label=timetree$tip.label, label2=timetree$tip.label)
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_NoBands_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-bitorques-BandedNeck_','Calamaria-bitorques_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade3-SpNov_','Calamaria-gervaisii3_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-andersoni-SYS-r001699','Calamaria-andersoni_SYS-r001699',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-1_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-2_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Oxyrhabdium-cf-modestum_','Oxyrhabdium-modestum2_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-christyi_','Polemon-christyi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-robustus_','Polemon-robustus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aparallactus-cf-capensis_','Aparallactus-capensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-cf-marenae_','Dendrelaphis-marenae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-cf-mcnamarae_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Raclitia-cf-indica_','Raclitia-indica_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tropidolaemus-cf-philippensis_','Tropidolaemus-philippensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Acrantophis-cf-dumerili_','Acrantophis-dumerili_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-cf-olivaceus_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerrhopilus-cf-hedraeus_','Gerrhopilus-hedraeus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sibynophis-geminatus-geminatus_','Sibynophis-geminatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Adelphicos-quadrivirgatus','Adelphicos-quadrivirgatum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhinotyphlops-schlegelii-mucruso_','Afrotyphlops-mucruso_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ahaetulla-fonticincta','Ahaetulla-fronticincta',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aspidomorphus-schlegeli_','Aspidomorphus-schlegelii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Atropoides-nummifer_','Metlapilcoatlus-nummifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-bilineata_','Calliophis-bilineatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-philippina_','Calliophis-philippinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Corallus-hortulanus_','Corallus-hortulana_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-caudolineatus-effrenis_','Dendrelaphis-effrenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-proarchos_','Dendrelaphis-pictus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dipsas-turgidus_','Dipsas-turgida_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Epicrates-angulifer_','Chilabothrus-angulifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Erythrolamprus-problematicus_','Arcanumophis-problematicus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Eryx-tataricus_','Eryx-miliaris_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gloydius-brevicaudus_','Gloydius-brevicauda_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gonionotophis-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Grayia-smythii','Grayia-smithii',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-khasiense_','Hebius-khasiensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-modestum_','Hebius-modestus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hierophis-caspius_','Dolichophis-caspius_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-mcdowelli_','Hydrophis-macdowelli_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Liopeltis-frenatus_','Liopeltis-frenata_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodonomorphus-laevessimus_','Lycodonomorphus-laevissimus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-effraensis_','Lycodon-effraenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-namdongensis_','Lycodon-chapaensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodryas-sanctijohannis_','Lycodryas-maculatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrovipera-lebetina_','Macrovipera-lebetinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Mehelya-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micrelaps-cf-muelleri_','Micrelaps-muelleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micropechis-ikaheka_','Micropechis-ikaheca_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Myriopholis-macrorhynchus_','Myriopholis-macrorhyncha_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Notechis-ater','Notechis-scutatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Philodryas-argentea_','Xenoxybelis-argenteus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Phimophis-iglesiasi_','Rodriguesophis-iglesiasi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pituophis-catenifer-vertebralis_','Pituophis-vertebralis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-notatum_','Polemon-notatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ptyas-multicinctus_','Ptyas-multicincta_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-sp_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-helleri_','Rhabdophis-helleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhagerhis-moilensis_','Malpolon-moilensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thamnophis-sauritus_','Thamnophis-saurita_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thrasops-jacksoni_','Thrasops-jacksonii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tricheilostoma-macrolepis_','Trilepida-macrolepis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Trimerodytes-balteata_','Trimerodytes-balteatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Typhlops-platycephalus_','Antillotyphlops-platycephalus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-sp_','Lycodon-alcalai_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-spNov-Luzon1_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hemibungarus-mcclungii_','Hemibungarus-mcclungi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thelotornis-capensis-mossambicanus','Thelotornis-mossambicanus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Chilabothrus-monensis-granti','Chilabothrus-granti',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_SanLuis-Aurora_CMNH5802','Pseudorabdion-mcnamarae_SanLuis-Aurora_CMNH5802',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_Siquijor_KU331732','Pseudorabdion-talonuran_Siquijor_KU331732',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Telescopus-fallax-iberus','Telescopus-fallax',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Coluber-constrictor-mormon','Coluber-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Masticophis-flagellum-flagellum','Masticophis-flagellum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Leptodeira-annulata-annulata','Leptodeira-annulata',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Vipera-aspis-hugyi','Vipera-aspis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sanzinia-madagascariensis-madagascariensis','Sanzinia-madagascariensis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Boa-constrictor-occidentalis','Boa-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Candoia-superciliosa-crombiei','Candoia-superciliosa',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Elaphe-taeniura-grabowskyi','Elaphe-taeniura',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-subminiatus','Rhabdophis-subminiatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-tigrinus-tigrinus|Rhabdophis-tigrinus-lateralis|Rhabdophis-tigrinus-formosanus','Rhabdophis-tigrinus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Craspedocephalus-sp_CESS074','Craspedocephalus-travancoricus_Kerala-India_BNHS3595',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Emydocephalus-annulatus_MGEa3','Emydocephalus-annulatus_NorthernTerritory-Australia_MGEa3',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-stokesii_As008','Hydrophis-stokesii_AshmoreReef-Australia_As008',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-curtus_Lc002','Hydrophis-curtus_Yongala-Queensland-Australia_Lc002',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Indotyphlops-braminus_ZCMV4006','Indotyphlops-braminus_Madagascar_ZCMV4006',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerarda-prevostiana_ZRC2.346','Gerarda-prevostiana_UnknownLocality_ZRC2.346',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aplopeltura-boa_Malaysia_KIZ11963','Aplopeltura-boa_PeninsularMalaysia_KIZ11963',tips.df[,'label2'])
grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2'])
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
timetree <- ape::read.nexus(treepath)#
#timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444",grep('Lycodon-capucinus|Indotyphlops-braminus',timetree$tip.label,value=TRUE)))#
timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444"))#
#
### If tips are shortnames, then load the file that maps the long names (with taxa and localities) to the short names (sample1, sample2, ...)#
# tips.df <- read.table("/Users/jeff/Documents/AllSnakes_Sanger/timetree4_shortnames_longnames2.txt", header=F,col.names=c("label","label2"))#
#
### If tip names already include taxon and locality info, then start a dataframe with a 'label' column holding the tip labels, and with a label2 column that can be identical to the label column or different if you need to map name changes to the tips#
tips.df <- data.frame(label=timetree$tip.label, label2=timetree$tip.label)#
#
#### Updating labels.#
# If some names in the 'label' column are in the incorrect format, then indicate corrected name in the 'label2' column.#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_NoBands_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-bitorques-BandedNeck_','Calamaria-bitorques_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade3-SpNov_','Calamaria-gervaisii3_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-andersoni-SYS-r001699','Calamaria-andersoni_SYS-r001699',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-1_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-2_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Oxyrhabdium-cf-modestum_','Oxyrhabdium-modestum2_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-christyi_','Polemon-christyi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-robustus_','Polemon-robustus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aparallactus-cf-capensis_','Aparallactus-capensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-cf-marenae_','Dendrelaphis-marenae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-cf-mcnamarae_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Raclitia-cf-indica_','Raclitia-indica_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tropidolaemus-cf-philippensis_','Tropidolaemus-philippensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Acrantophis-cf-dumerili_','Acrantophis-dumerili_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-cf-olivaceus_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerrhopilus-cf-hedraeus_','Gerrhopilus-hedraeus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sibynophis-geminatus-geminatus_','Sibynophis-geminatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Adelphicos-quadrivirgatus','Adelphicos-quadrivirgatum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhinotyphlops-schlegelii-mucruso_','Afrotyphlops-mucruso_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ahaetulla-fonticincta','Ahaetulla-fronticincta',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aspidomorphus-schlegeli_','Aspidomorphus-schlegelii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Atropoides-nummifer_','Metlapilcoatlus-nummifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-bilineata_','Calliophis-bilineatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-philippina_','Calliophis-philippinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Corallus-hortulanus_','Corallus-hortulana_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-caudolineatus-effrenis_','Dendrelaphis-effrenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-proarchos_','Dendrelaphis-pictus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dipsas-turgidus_','Dipsas-turgida_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Epicrates-angulifer_','Chilabothrus-angulifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Erythrolamprus-problematicus_','Arcanumophis-problematicus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Eryx-tataricus_','Eryx-miliaris_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gloydius-brevicaudus_','Gloydius-brevicauda_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gonionotophis-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Grayia-smythii','Grayia-smithii',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-khasiense_','Hebius-khasiensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-modestum_','Hebius-modestus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hierophis-caspius_','Dolichophis-caspius_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-mcdowelli_','Hydrophis-macdowelli_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Liopeltis-frenatus_','Liopeltis-frenata_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodonomorphus-laevessimus_','Lycodonomorphus-laevissimus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-effraensis_','Lycodon-effraenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-namdongensis_','Lycodon-chapaensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodryas-sanctijohannis_','Lycodryas-maculatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrovipera-lebetina_','Macrovipera-lebetinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Mehelya-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micrelaps-cf-muelleri_','Micrelaps-muelleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micropechis-ikaheka_','Micropechis-ikaheca_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Myriopholis-macrorhynchus_','Myriopholis-macrorhyncha_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Notechis-ater','Notechis-scutatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Philodryas-argentea_','Xenoxybelis-argenteus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Phimophis-iglesiasi_','Rodriguesophis-iglesiasi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pituophis-catenifer-vertebralis_','Pituophis-vertebralis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-notatum_','Polemon-notatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ptyas-multicinctus_','Ptyas-multicincta_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-sp_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-helleri_','Rhabdophis-helleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhagerhis-moilensis_','Malpolon-moilensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thamnophis-sauritus_','Thamnophis-saurita_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thrasops-jacksoni_','Thrasops-jacksonii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tricheilostoma-macrolepis_','Trilepida-macrolepis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Trimerodytes-balteata_','Trimerodytes-balteatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Typhlops-platycephalus_','Antillotyphlops-platycephalus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-sp_','Lycodon-alcalai_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-spNov-Luzon1_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hemibungarus-mcclungii_','Hemibungarus-mcclungi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thelotornis-capensis-mossambicanus','Thelotornis-mossambicanus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Chilabothrus-monensis-granti','Chilabothrus-granti',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_SanLuis-Aurora_CMNH5802','Pseudorabdion-mcnamarae_SanLuis-Aurora_CMNH5802',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_Siquijor_KU331732','Pseudorabdion-talonuran_Siquijor_KU331732',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Telescopus-fallax-iberus','Telescopus-fallax',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Coluber-constrictor-mormon','Coluber-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Masticophis-flagellum-flagellum','Masticophis-flagellum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Leptodeira-annulata-annulata','Leptodeira-annulata',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Vipera-aspis-hugyi','Vipera-aspis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sanzinia-madagascariensis-madagascariensis','Sanzinia-madagascariensis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Boa-constrictor-occidentalis','Boa-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Candoia-superciliosa-crombiei','Candoia-superciliosa',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Elaphe-taeniura-grabowskyi','Elaphe-taeniura',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-subminiatus','Rhabdophis-subminiatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-tigrinus-tigrinus|Rhabdophis-tigrinus-lateralis|Rhabdophis-tigrinus-formosanus','Rhabdophis-tigrinus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Craspedocephalus-sp_CESS074','Craspedocephalus-travancoricus_Kerala-India_BNHS3595',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Emydocephalus-annulatus_MGEa3','Emydocephalus-annulatus_NorthernTerritory-Australia_MGEa3',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-stokesii_As008','Hydrophis-stokesii_AshmoreReef-Australia_As008',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-curtus_Lc002','Hydrophis-curtus_Yongala-Queensland-Australia_Lc002',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Indotyphlops-braminus_ZCMV4006','Indotyphlops-braminus_Madagascar_ZCMV4006',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerarda-prevostiana_ZRC2.346','Gerarda-prevostiana_UnknownLocality_ZRC2.346',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aplopeltura-boa_Malaysia_KIZ11963','Aplopeltura-boa_PeninsularMalaysia_KIZ11963',tips.df[,'label2'])
grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2'])
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
tips.df[,'taxon']   <- gsub("_.*","",tips.df[,'label2'])#
tips.df[,'genus']   <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){x[1]})#
tips.df[,'species'] <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# load table with names of species recognized by Reptile Database#
RDBtaxa.df <- read.table(taxonomypath,header=T,sep='\t')#
RDBtaxa.df[,'Species'] <- gsub(' ','-',RDBtaxa.df[,'Species'])#
RDBtaxa.df[,'Genus'] <- sapply(strsplit(RDBtaxa.df[,'Species'],split=' |-'),function(x){x[1]})#
### Load checklist of taxa that occur in the philippines#
# NOTE: ADDED Malayotyphlops-sp to checklist because need to ID specimens (Siquijor)!#
checklist.df <- read.table(checklistpath, header=F,col.names="taxon")
head(checklist.df)
missing <- setdiff(tips.df[,'taxon'],c(RDBtaxa.df[,'Species'],checklist.df[,'taxon']))
missing
missing <- setdiff(tips.df[,'taxon'],c(RDBtaxa.df[,'Species'],checklist.df[,'taxon']))
checklist.df[,'genus']   <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){x[1]})#
checklist.df[,'species'] <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})
head(checklist.df)
tips.df[,'genus.philippines']   <- (tips.df[,'genus'] %in% checklist.df[,'genus'])#
tips.df[,'species.philippines'] <- (tips.df[,'species'] %in% checklist.df[,'species'] | tips.df[,'species'] %in% checklist.df[,'taxon'])#
#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
patt='Adams-IlocosNorte';repl='Adams-IlocosNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='AgusanSur';repl='AgusanSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Alcoy-Cebu';repl='Alcoy-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Argao-Cebu';repl='Argao-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bacacay-Albay';repl='Bacacay-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Balangiga-Samar';repl='Balangiga-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Basco-BatanIsl';repl='Basco-BatanIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Baybay-Leyte'; repl='Baybay-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bilar-Bohol'; repl='Bilar-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bohol'; repl='Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='BrookesPoint-Palawan'; repl='BrookesPoint-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buenavista-Guimaras'; repl='Buenavista-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buhi-Bicol'; repl='Buhi-Bicol-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bulan-Sorsogon'; repl='Bulan-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burauen-Leyte'; repl='Burauen-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burdeos-Polillo'; repl='Burdeos-Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CalayanIsl'; repl='CalayanIsl-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Calinan-DavaoCity'; repl='Calinan-DavaoCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamarinesSur'; repl='CamarinesSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinNorte'; repl='CamiguinNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinSur'; repl='CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Catanduanes'; repl='Catanduanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Cebu'; repl='Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CentralJava'; repl='CentralProvince-Java-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dalupiri'; repl='Dalupiri-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dumagete-Negros'; repl='Dumagete-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='EstrellaFalls-Palawan'; repl='EstrellaFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity'; repl='GingoogCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity-MisamisOriental'; repl='GingoogCity-MisamisOriental-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Glan-Sarangani'; repl='Glan-Sarangani-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Cagayan'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Luzon'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Hilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='IlocosSur'; repl='IlocosSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irawan-Palawan'; repl='Irawan-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irosin-Sorsogon'; repl='Irosin-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Jordan-Guimaras'; repl='Jordan-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kalimantan-Borneo'; repl='Kalimantan-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Keningau-Sabah'; repl='Keningau-Sabah-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kiblawan-DavaoSur'; repl='Kiblawan-DavaoSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kolombangara-SolomonIslands'; repl='Kolombangara-SolomonIslands'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesNorte'; repl='Labo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesSur'; repl='Labo-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LakeTaal-Philippines'; repl='LakeTaal-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Langkawi-WestMalaysia'; repl='Langkawi-WestMalaysia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LaTrinidad-Benguet'; repl='LaTrinidad-Benguet-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Leyte'; repl='Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto-Dinagat'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LosBanos-Laguna'; repl='LosBanos-Laguna-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Lubang'; repl='Lubang-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Luzon'; repl='Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magdiwang-Sibuyan'; repl='Magdiwang-Sibuyan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga'; repl='Magrafil-Gonzaga-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga-Cagayan'; repl='Magrafil-Gonzaga-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magsaysay-Mindoro'; repl='Magsaysay-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MainitFalls-Palawan'; repl='MainitFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Malinao-Albay'; repl='Malinao-Albay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Mambajao-CamiguinSur'; repl='Mambajao-CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MariaAurora-Aurora'; repl='MariaAurora-Aurora-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Marinduque'; repl='Marinduque-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Matingaram-Mindoro'; repl='Matingaram-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Moalboal-Cebu'; repl='Moalboal-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtBanahao'; repl='MtBanahao-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHuraw-Samar'; repl='MtHuraw-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtLabo-CamarinesNorte'; repl='MtLabo-CamarinesNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Narra-Palawan'; repl='Narra-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NiasIsland'; repl='Nias-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NorthSulawesi'; repl='NorthProvince-Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Norzagaray-Bulacan'; repl='Norzagaray-Bulacan-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Palawan'; repl='Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Panay'; repl='Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Antique'; repl='Pandan-Antique-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Panay'; repl='Pandan-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Poblacion-CaluyaIsl'; repl='Poblacion-CaluyaIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Polillo'; repl='Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Presentacion-CamarinesSur'; repl='Presentacion-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoGalera-Mindoro'; repl='PuertoGalera-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrinc-Palawan'; repl='PuertoPrinc-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrincessa-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaViscaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaVizcaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Real-Quezon'; repl='Real-Quezon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom';repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom-AgusanDelNorte'; repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Rizal-Palawan'; repl='Rizal-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sablayan-Mindoro'; repl='Sablayan-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang-Batanes'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Samar'; repl='Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFran-AgusanSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFrancisco-AgusanDelSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanLuis-Aurora'; repl='SanLuis-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanMariano-Isabela'; repl='SanMariano-Isabela-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRafael-Samar'; repl='SanRafael-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Antique'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Panay'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SelayarIsland'; repl='SelayarIsland-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SierraBullones-Bohol'; repl='SierraBullones-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Silay-Negros'; repl='Silay-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sipacot-CamarinesSur'; repl='Sipacot-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Siquijor'; repl='Siquijor-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sogud-SouthernLeyte'; repl='Sogud-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sorsogon'; repl='Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sulawesi'; repl='Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SuluIsl'; repl='Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumatra'; repl='Sumatra-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumbawa'; repl='Sumbawa-LesserSunda-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tablas'; repl='Tablas-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-EasternSamar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-Samar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotabato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotobato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='TawiTawi'; repl='TawiTawi-Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Ternate-Cavite'; repl='Ternate-Cavite-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Bohol'; repl='Valencia-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Negros'; repl='Valencia-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasanonca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Mindanao'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PasonancaZamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga-Pasononca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
locality.list <- strsplit(tips.df[,'locality'],split='-')#
tips.df[,'sample.philippines'] <- sapply(locality.list,function(x){any(x=='Philippines')})#
tips.df[is.na(tips.df[,'sample.philippines']),'sample.philippines'] <- FALSE
tips.df[grep("Lycodon-capucinus|Indotyphlops",tips.df[,'label2']),]
rangesmat      <- do.call(rbind,lapply(strsplit(readLines(rangespath),split='\t'),function(x){x[2:3]}))#
rangesmat      <- rangesmat[!is.na(rangesmat[,1]),]#
rangesmat[,1]  <- gsub(" ","-",rangesmat[,1])#
rangesmat[,2]  <- gsub('Afrotropics/Seychelles','Afrotropics',gsub('Americas/Caribbean','Americas',rangesmat[,2]))#
rangesmat[,2]  <- gsub(',','',sapply(strsplit(rangesmat[,2],split=' '),function(x){paste(sort(x),collapse=' ')}))#
# sort(unique(rangesmat[,2]))#
tips.df[,'species.biogeog'] <- rangesmat[match(tips.df[,'species'],rangesmat[,1]),2]#
#
### Add column with the biogeographic realms that the genus occurs in...#
#
## Add a column (geog1) with biogeographic realms of species for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#tips.df[,'geog1'] <- NA#
tips.df[tips.df[,'sample.philippines']==TRUE,'geog1']   <- 'Philippines'#
tips.df[tips.df[,'species.philippines']==FALSE,'geog1'] <- tips.df[tips.df[,'species.philippines']==FALSE,'species.biogeog']#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Australia|SolomonIslands|NewGuinea',tips.df[,'locality']), 'geog1'] <- 'Oceanea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Java|Borneo|Sumatra|Malaysia|Nias-Indonesia',tips.df[,'locality']), 'geog1'] <- 'Sundaland'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Selayar|Sulawesi|Sumbawa',tips.df[,'locality']), 'geog1'] <- 'Wallacea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Thailand|Cambodia|Laos|Vietnam|Guangdong-China|Guangxi-China|Ayeyarwady-Myanmar|Yunan-China',tips.df[,'locality']), 'geog1'] <- 'Indochina'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('BitarKanika-Odisha-India',tips.df[,'locality']), 'geog1'] <- 'IndianSC'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('UnknownLocality',tips.df[,'locality']), 'geog1'] <- NA
clades.list <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.philippines']==T,'label'])
clades.list
grep('capucinus',clades.list)
clades.list[grep('capucinus',clades.list)]
length(clades.list)
clades.list <- clades.list[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list)]
length(clades.list)
clades.list
timetree2  <- treeio::read.beast(treepath)#
  # Only keep tips that are in timetree#
  timetree2  <- treeio::drop.tip(timetree2,setdiff(dplyr::select(timetree2,label)[!is.na(dplyr::select(timetree2,label))],timetree$tip.label))#
#
  # tibble with node ages#
  dates <- attributes(timetree2)$data#
  # get age at each crown node of each clade#
  crownages_CI   <- lapply(clades.list,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(clades.list,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height'])})#
  tib            <- tibble::as_tibble(timetree2)#
  crown.nodes    <- unname(sapply(clades.list,function(x){MRCA(timetree2,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  #crownages_CI   <- do.call(c,(tib[match(crown.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  #crownages_mean <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
#
  ages.df <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)
clades.allnodes <- unique(c(unlist(lapply(crown.nodes,function(x){Descendants(as.phylo(timetree2),node=x,type="all")})),crown.nodes))#
  coldf           <- data.frame(node=1:nrow(dates),color="gray")#
  coldf[coldf[,'node'] %in% clades.allnodes,'color'] <- 'black'#
  # read fossil calibrations data#
  calibrations <- strsplit(gsub('.*= +|;','',readLines(calibrationspath)), split=' ')#
  nodes.calibrated <- sapply(calibrations,function(x){MRCA(timetree2,intersect(x,as.phylo(timetree2)$tip.label))})
tree1 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% coldf + aes(color=I(color)) + ggtree::geom_treescale(fontsize=4,offset=1,linesize=0.5,width=20,x=10,y=length(timetree2@phylo$tip.label)/2) + geom_nodelab(aes(subset = (node %in% nodes.calibrated), label = "*"), color = "black", size=4)
tree1
head(tips.df)
length(unique(tips.df[,'locality']))
unique(tips.df[,'locality'])
patt='MariaAurora-Aurora-Philippines'; repl='MariaAurora-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])
patt='Pandan-Antique-Luzon-Philippines'; repl='Pandan-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])
unique(tips.df[tips.df[,'sample.philippines'==T],'locality'])
unique(tips.df[tips.df[,'sample.philippines']==T,'locality'])
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
#
######################
## Updating Locality Strings#
patt='Adams-IlocosNorte';repl='Adams-IlocosNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='AgusanSur';repl='AgusanSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Alcoy-Cebu';repl='Alcoy-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Argao-Cebu';repl='Argao-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bacacay-Albay';repl='Bacacay-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Balangiga-Samar';repl='Balangiga-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Basco-BatanIsl';repl='Basco-BatanIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Baybay-Leyte'; repl='Baybay-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bilar-Bohol'; repl='Bilar-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bohol'; repl='Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='BrookesPoint-Palawan'; repl='BrookesPoint-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buenavista-Guimaras'; repl='Buenavista-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buhi-Bicol'; repl='Buhi-Bicol-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bulan-Sorsogon'; repl='Bulan-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burauen-Leyte'; repl='Burauen-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burdeos-Polillo'; repl='Burdeos-Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CalayanIsl'; repl='CalayanIsl-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Calinan-DavaoCity'; repl='Calinan-DavaoCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamarinesSur'; repl='CamarinesSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinNorte'; repl='CamiguinNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinSur'; repl='CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Catanduanes'; repl='Catanduanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Cebu'; repl='Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CentralJava'; repl='CentralProvince-Java-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dalupiri'; repl='Dalupiri-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dumagete-Negros'; repl='Dumagete-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='EstrellaFalls-Palawan'; repl='EstrellaFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity'; repl='GingoogCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity-MisamisOriental'; repl='GingoogCity-MisamisOriental-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Glan-Sarangani'; repl='Glan-Sarangani-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Cagayan'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Luzon'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Hilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='IlocosSur'; repl='IlocosSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irawan-Palawan'; repl='Irawan-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irosin-Sorsogon'; repl='Irosin-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Jordan-Guimaras'; repl='Jordan-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kalimantan-Borneo'; repl='Kalimantan-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Keningau-Sabah'; repl='Keningau-Sabah-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kiblawan-DavaoSur'; repl='Kiblawan-DavaoSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kolombangara-SolomonIslands'; repl='Kolombangara-SolomonIslands'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesNorte'; repl='Labo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesSur'; repl='Labo-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LakeTaal-Philippines'; repl='LakeTaal-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Langkawi-WestMalaysia'; repl='Langkawi-WestMalaysia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LaTrinidad-Benguet'; repl='LaTrinidad-Benguet-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Leyte'; repl='Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto-Dinagat'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LosBanos-Laguna'; repl='LosBanos-Laguna-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Lubang'; repl='Lubang-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Luzon'; repl='Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magdiwang-Sibuyan'; repl='Magdiwang-Sibuyan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga-Cagayan'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magsaysay-Mindoro'; repl='Magsaysay-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MainitFalls-Palawan'; repl='MainitFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Malinao-Albay'; repl='Malinao-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Mambajao-CamiguinSur'; repl='Mambajao-CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MariaAurora-Aurora'; repl='MariaAurora-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Marinduque'; repl='Marinduque-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Matingaram-Mindoro'; repl='Matingaram-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Moalboal-Cebu'; repl='Moalboal-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtBanahao'; repl='MtBanahao-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHuraw-Samar'; repl='MtHuraw-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtLabo-CamarinesNorte'; repl='MtLabo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Narra-Palawan'; repl='Narra-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NiasIsland'; repl='Nias-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NorthSulawesi'; repl='NorthProvince-Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Norzagaray-Bulacan'; repl='Norzagaray-Bulacan-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Palawan'; repl='Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Panay'; repl='Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Antique'; repl='Pandan-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Panay'; repl='Pandan-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Poblacion-CaluyaIsl'; repl='Poblacion-CaluyaIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Polillo'; repl='Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Presentacion-CamarinesSur'; repl='Presentacion-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoGalera-Mindoro'; repl='PuertoGalera-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrinc-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrincessa-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaViscaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaVizcaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Real-Quezon'; repl='Real-Quezon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom';repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom-AgusanDelNorte'; repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Rizal-Palawan'; repl='Rizal-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sablayan-Mindoro'; repl='Sablayan-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang-Batanes'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Samar'; repl='Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFran-AgusanSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFrancisco-AgusanDelSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanLuis-Aurora'; repl='SanLuis-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanMariano-Isabela'; repl='SanMariano-Isabela-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRafael-Samar'; repl='SanRafael-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Antique'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Panay'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SelayarIsland'; repl='SelayarIsland-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SierraBullones-Bohol'; repl='SierraBullones-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Silay-Negros'; repl='Silay-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sipacot-CamarinesSur'; repl='Sipacot-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Siquijor'; repl='Siquijor-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sogud-SouthernLeyte'; repl='Sogud-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sorsogon'; repl='Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sulawesi'; repl='Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SuluIsl'; repl='Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumatra'; repl='Sumatra-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumbawa'; repl='Sumbawa-LesserSunda-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tablas'; repl='Tablas-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-EasternSamar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-Samar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotabato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotobato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='TawiTawi'; repl='TawiTawi-Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Ternate-Cavite'; repl='Ternate-Cavite-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Bohol'; repl='Valencia-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Negros'; repl='Valencia-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasanonca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Mindanao'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PasonancaZamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga-Pasononca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
#
######################################################
# Updates locality column after making changes to label2#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
######################################################
#
### Add column indicating if the sample locality is in the Philippines#
locality.list <- strsplit(tips.df[,'locality'],split='-')#
tips.df[,'sample.philippines'] <- sapply(locality.list,function(x){any(x=='Philippines')})#
tips.df[is.na(tips.df[,'sample.philippines']),'sample.philippines'] <- FALSE#
#
### Add column with the biogeographic realms that the species occurs in#
rangesmat      <- do.call(rbind,lapply(strsplit(readLines(rangespath),split='\t'),function(x){x[2:3]}))#
rangesmat      <- rangesmat[!is.na(rangesmat[,1]),]#
rangesmat[,1]  <- gsub(" ","-",rangesmat[,1])#
rangesmat[,2]  <- gsub('Afrotropics/Seychelles','Afrotropics',gsub('Americas/Caribbean','Americas',rangesmat[,2]))#
rangesmat[,2]  <- gsub(',','',sapply(strsplit(rangesmat[,2],split=' '),function(x){paste(sort(x),collapse=' ')}))#
# sort(unique(rangesmat[,2]))#
tips.df[,'species.biogeog'] <- rangesmat[match(tips.df[,'species'],rangesmat[,1]),2]#
#
### Add column with the biogeographic realms that the genus occurs in...#
#
## Add a column (geog1) with biogeographic realms of species for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#tips.df[,'geog1'] <- NA#
tips.df[tips.df[,'sample.philippines']==TRUE,'geog1']   <- 'Philippines'#
tips.df[tips.df[,'species.philippines']==FALSE,'geog1'] <- tips.df[tips.df[,'species.philippines']==FALSE,'species.biogeog']#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Australia|SolomonIslands|NewGuinea',tips.df[,'locality']), 'geog1'] <- 'Oceanea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Java|Borneo|Sumatra|Malaysia|Nias-Indonesia',tips.df[,'locality']), 'geog1'] <- 'Sundaland'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Selayar|Sulawesi|Sumbawa',tips.df[,'locality']), 'geog1'] <- 'Wallacea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Thailand|Cambodia|Laos|Vietnam|Guangdong-China|Guangxi-China|Ayeyarwady-Myanmar|Yunan-China',tips.df[,'locality']), 'geog1'] <- 'Indochina'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('BitarKanika-Odisha-India',tips.df[,'locality']), 'geog1'] <- 'IndianSC'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('UnknownLocality',tips.df[,'locality']), 'geog1'] <- NA
unique(tips.df[tips.df[,'sample.philippines']==T,'locality'])
grep('Mindoro-',tips.df[,'locality'])
tips.df[grep('Mindoro-',tips.df[,'locality']),'Mindoro'] <- TRUE
head(tips.df)
unique(tips.df[,'Mindoro'])
tips.df[grep('Guimaras-|Panay-|Negros-|Cebu-|Masbate-',tips.df[,'locality']),'WestVisayas'] <- TRUE
head(tips.df)
tips.df[grep('Palawan-',tips.df[,'locality']),'Palawan'] <- TRUE
head(tips.df)
tips.df <- data.frame(label=timetree$tip.label, label2=timetree$tip.label)#
#
#### Updating labels.#
# If some names in the 'label' column are in the incorrect format, then indicate corrected name in the 'label2' column.#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_NoBands_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-bitorques-BandedNeck_','Calamaria-bitorques_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade3-SpNov_','Calamaria-gervaisii3_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-andersoni-SYS-r001699','Calamaria-andersoni_SYS-r001699',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-1_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-2_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Oxyrhabdium-cf-modestum_','Oxyrhabdium-modestum2_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-christyi_','Polemon-christyi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-robustus_','Polemon-robustus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aparallactus-cf-capensis_','Aparallactus-capensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-cf-marenae_','Dendrelaphis-marenae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-cf-mcnamarae_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Raclitia-cf-indica_','Raclitia-indica_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tropidolaemus-cf-philippensis_','Tropidolaemus-philippensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Acrantophis-cf-dumerili_','Acrantophis-dumerili_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-cf-olivaceus_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerrhopilus-cf-hedraeus_','Gerrhopilus-hedraeus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sibynophis-geminatus-geminatus_','Sibynophis-geminatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Adelphicos-quadrivirgatus','Adelphicos-quadrivirgatum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhinotyphlops-schlegelii-mucruso_','Afrotyphlops-mucruso_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ahaetulla-fonticincta','Ahaetulla-fronticincta',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aspidomorphus-schlegeli_','Aspidomorphus-schlegelii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Atropoides-nummifer_','Metlapilcoatlus-nummifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-bilineata_','Calliophis-bilineatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-philippina_','Calliophis-philippinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Corallus-hortulanus_','Corallus-hortulana_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-caudolineatus-effrenis_','Dendrelaphis-effrenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-proarchos_','Dendrelaphis-pictus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dipsas-turgidus_','Dipsas-turgida_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Epicrates-angulifer_','Chilabothrus-angulifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Erythrolamprus-problematicus_','Arcanumophis-problematicus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Eryx-tataricus_','Eryx-miliaris_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gloydius-brevicaudus_','Gloydius-brevicauda_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gonionotophis-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Grayia-smythii','Grayia-smithii',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-khasiense_','Hebius-khasiensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-modestum_','Hebius-modestus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hierophis-caspius_','Dolichophis-caspius_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-mcdowelli_','Hydrophis-macdowelli_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Liopeltis-frenatus_','Liopeltis-frenata_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodonomorphus-laevessimus_','Lycodonomorphus-laevissimus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-effraensis_','Lycodon-effraenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-namdongensis_','Lycodon-chapaensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodryas-sanctijohannis_','Lycodryas-maculatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrovipera-lebetina_','Macrovipera-lebetinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Mehelya-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micrelaps-cf-muelleri_','Micrelaps-muelleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micropechis-ikaheka_','Micropechis-ikaheca_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Myriopholis-macrorhynchus_','Myriopholis-macrorhyncha_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Notechis-ater','Notechis-scutatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Philodryas-argentea_','Xenoxybelis-argenteus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Phimophis-iglesiasi_','Rodriguesophis-iglesiasi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pituophis-catenifer-vertebralis_','Pituophis-vertebralis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-notatum_','Polemon-notatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ptyas-multicinctus_','Ptyas-multicincta_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-sp_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-helleri_','Rhabdophis-helleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhagerhis-moilensis_','Malpolon-moilensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thamnophis-sauritus_','Thamnophis-saurita_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thrasops-jacksoni_','Thrasops-jacksonii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tricheilostoma-macrolepis_','Trilepida-macrolepis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Trimerodytes-balteata_','Trimerodytes-balteatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Typhlops-platycephalus_','Antillotyphlops-platycephalus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-sp_','Lycodon-alcalai_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-spNov-Luzon1_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hemibungarus-mcclungii_','Hemibungarus-mcclungi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thelotornis-capensis-mossambicanus','Thelotornis-mossambicanus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Chilabothrus-monensis-granti','Chilabothrus-granti',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_SanLuis-Aurora_CMNH5802','Pseudorabdion-mcnamarae_SanLuis-Aurora_CMNH5802',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_Siquijor_KU331732','Pseudorabdion-talonuran_Siquijor_KU331732',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Telescopus-fallax-iberus','Telescopus-fallax',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Coluber-constrictor-mormon','Coluber-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Masticophis-flagellum-flagellum','Masticophis-flagellum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Leptodeira-annulata-annulata','Leptodeira-annulata',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Vipera-aspis-hugyi','Vipera-aspis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sanzinia-madagascariensis-madagascariensis','Sanzinia-madagascariensis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Boa-constrictor-occidentalis','Boa-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Candoia-superciliosa-crombiei','Candoia-superciliosa',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Elaphe-taeniura-grabowskyi','Elaphe-taeniura',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-subminiatus','Rhabdophis-subminiatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-tigrinus-tigrinus|Rhabdophis-tigrinus-lateralis|Rhabdophis-tigrinus-formosanus','Rhabdophis-tigrinus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Craspedocephalus-sp_CESS074','Craspedocephalus-travancoricus_Kerala-India_BNHS3595',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Emydocephalus-annulatus_MGEa3','Emydocephalus-annulatus_NorthernTerritory-Australia_MGEa3',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-stokesii_As008','Hydrophis-stokesii_AshmoreReef-Australia_As008',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-curtus_Lc002','Hydrophis-curtus_Yongala-Queensland-Australia_Lc002',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Indotyphlops-braminus_ZCMV4006','Indotyphlops-braminus_Madagascar_ZCMV4006',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerarda-prevostiana_ZRC2.346','Gerarda-prevostiana_UnknownLocality_ZRC2.346',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aplopeltura-boa_Malaysia_KIZ11963','Aplopeltura-boa_PeninsularMalaysia_KIZ11963',tips.df[,'label2'])#
#
# ZRC2.346 # #
# ZCMV4006 # Madagascar_ZCMV4006#
#
# tips.df[which(tips.df[,'locality']=='ZCMV4006'),]#
#
##############
# Australia ##
##############
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#
# Samples need to include origin country in label, except for Indonesian, Malaysia, and Philippines samples, which need to include island name. Other geographical information can also be present.#
##########
# You can check label2 formatting with by splitting names and checking how many fields were generated.#
# labels.parts <- strsplit(tips.df[,'label2'],split='_')#
# table(lengths(labels.parts))#
#
### Add columns to hold taxon identity information for each tip#
tips.df[,'taxon']   <- gsub("_.*","",tips.df[,'label2'])#
tips.df[,'genus']   <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){x[1]})#
tips.df[,'species'] <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# load table with names of species recognized by Reptile Database#
RDBtaxa.df <- read.table(taxonomypath,header=T,sep='\t')#
RDBtaxa.df[,'Species'] <- gsub(' ','-',RDBtaxa.df[,'Species'])#
RDBtaxa.df[,'Genus'] <- sapply(strsplit(RDBtaxa.df[,'Species'],split=' |-'),function(x){x[1]})#
### Load checklist of taxa that occur in the philippines#
# NOTE: ADDED Malayotyphlops-sp to checklist because need to ID specimens (Siquijor)!#
checklist.df <- read.table(checklistpath, header=F,col.names="taxon")#
#
# Check if any sampled taxa are not in RDB database or the Philippines checklist#
missing <- setdiff(tips.df[,'taxon'],c(RDBtaxa.df[,'Species'],checklist.df[,'taxon']))#
#
# taxon.parts <- strsplit(tips.df[,'taxon'],split='-')#
# table(lengths(taxon.parts))#
# grep('-cf-',tips.df[,'taxon'])#
# tips.df[grep('Argyrophis-sp',tips.df[,'label2']),]#
#
# tips.df[,'genus']   <- gsub("-.*","",tips.df[,'label2'])#
# tips.df[,'species'] <- gsub("_.*","",tips.df[,'label2'])#
#
### Load checklist of taxa that occur in the philippines#
# speciesPH  <- read.table(checklistpath, header=F,col.names="taxon")#
# checklist.df <- read.table(checklistpath, header=F,col.names="taxon")#
# add columns to checklist.df with genus and Genus-species names parsed from the taxon column#
checklist.df[,'genus']   <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){x[1]})#
checklist.df[,'species'] <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# Indicate if tip genus/species/individual occurs in the Philippines#
tips.df[,'genus.philippines']   <- (tips.df[,'genus'] %in% checklist.df[,'genus'])#
tips.df[,'species.philippines'] <- (tips.df[,'species'] %in% checklist.df[,'species'] | tips.df[,'species'] %in% checklist.df[,'taxon'])#
#
### initial locality strings inferred from tip labels#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
#
######################
## Updating Locality Strings#
patt='Adams-IlocosNorte';repl='Adams-IlocosNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='AgusanSur';repl='AgusanSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Alcoy-Cebu';repl='Alcoy-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Argao-Cebu';repl='Argao-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bacacay-Albay';repl='Bacacay-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Balangiga-Samar';repl='Balangiga-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Basco-BatanIsl';repl='Basco-BatanIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Baybay-Leyte'; repl='Baybay-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bilar-Bohol'; repl='Bilar-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bohol'; repl='Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='BrookesPoint-Palawan'; repl='BrookesPoint-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buenavista-Guimaras'; repl='Buenavista-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buhi-Bicol'; repl='Buhi-Bicol-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bulan-Sorsogon'; repl='Bulan-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burauen-Leyte'; repl='Burauen-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burdeos-Polillo'; repl='Burdeos-Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CalayanIsl'; repl='CalayanIsl-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Calinan-DavaoCity'; repl='Calinan-DavaoCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamarinesSur'; repl='CamarinesSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinNorte'; repl='CamiguinNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinSur'; repl='CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Catanduanes'; repl='Catanduanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Cebu'; repl='Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CentralJava'; repl='CentralProvince-Java-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dalupiri'; repl='Dalupiri-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dumagete-Negros'; repl='Dumagete-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='EstrellaFalls-Palawan'; repl='EstrellaFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity'; repl='GingoogCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity-MisamisOriental'; repl='GingoogCity-MisamisOriental-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Glan-Sarangani'; repl='Glan-Sarangani-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Cagayan'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Luzon'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Hilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='IlocosSur'; repl='IlocosSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irawan-Palawan'; repl='Irawan-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irosin-Sorsogon'; repl='Irosin-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Jordan-Guimaras'; repl='Jordan-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kalimantan-Borneo'; repl='Kalimantan-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Keningau-Sabah'; repl='Keningau-Sabah-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kiblawan-DavaoSur'; repl='Kiblawan-DavaoSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kolombangara-SolomonIslands'; repl='Kolombangara-SolomonIslands'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesNorte'; repl='Labo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesSur'; repl='Labo-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LakeTaal-Philippines'; repl='LakeTaal-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Langkawi-WestMalaysia'; repl='Langkawi-WestMalaysia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LaTrinidad-Benguet'; repl='LaTrinidad-Benguet-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Leyte'; repl='Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto-Dinagat'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LosBanos-Laguna'; repl='LosBanos-Laguna-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Lubang'; repl='Lubang-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Luzon'; repl='Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magdiwang-Sibuyan'; repl='Magdiwang-Sibuyan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga-Cagayan'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magsaysay-Mindoro'; repl='Magsaysay-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MainitFalls-Palawan'; repl='MainitFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Malinao-Albay'; repl='Malinao-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Mambajao-CamiguinSur'; repl='Mambajao-CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MariaAurora-Aurora'; repl='MariaAurora-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Marinduque'; repl='Marinduque-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Matingaram-Mindoro'; repl='Matingaram-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Moalboal-Cebu'; repl='Moalboal-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtBanahao'; repl='MtBanahao-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHuraw-Samar'; repl='MtHuraw-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtLabo-CamarinesNorte'; repl='MtLabo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Narra-Palawan'; repl='Narra-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NiasIsland'; repl='Nias-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NorthSulawesi'; repl='NorthProvince-Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Norzagaray-Bulacan'; repl='Norzagaray-Bulacan-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Palawan'; repl='Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Panay'; repl='Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Antique'; repl='Pandan-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Panay'; repl='Pandan-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Poblacion-CaluyaIsl'; repl='Poblacion-CaluyaIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Polillo'; repl='Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Presentacion-CamarinesSur'; repl='Presentacion-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoGalera-Mindoro'; repl='PuertoGalera-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrinc-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrincessa-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaViscaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaVizcaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Real-Quezon'; repl='Real-Quezon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom';repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom-AgusanDelNorte'; repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Rizal-Palawan'; repl='Rizal-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sablayan-Mindoro'; repl='Sablayan-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang-Batanes'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Samar'; repl='Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFran-AgusanSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFrancisco-AgusanDelSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanLuis-Aurora'; repl='SanLuis-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanMariano-Isabela'; repl='SanMariano-Isabela-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRafael-Samar'; repl='SanRafael-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Antique'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Panay'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SelayarIsland'; repl='SelayarIsland-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SierraBullones-Bohol'; repl='SierraBullones-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Silay-Negros'; repl='Silay-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sipacot-CamarinesSur'; repl='Sipacot-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Siquijor'; repl='Siquijor-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sogud-SouthernLeyte'; repl='Sogud-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sorsogon'; repl='Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sulawesi'; repl='Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SuluIsl'; repl='Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumatra'; repl='Sumatra-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumbawa'; repl='Sumbawa-LesserSunda-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tablas'; repl='Tablas-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-EasternSamar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-Samar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotabato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotobato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='TawiTawi'; repl='TawiTawi-Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Ternate-Cavite'; repl='Ternate-Cavite-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Bohol'; repl='Valencia-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Negros'; repl='Valencia-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasanonca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Mindanao'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PasonancaZamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga-Pasononca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
#
######################################################
# Updates locality column after making changes to label2#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
######################################################
#
### Add column indicating if the sample locality is in the Philippines#
locality.list <- strsplit(tips.df[,'locality'],split='-')#
tips.df[,'sample.philippines'] <- sapply(locality.list,function(x){any(x=='Philippines')})#
tips.df[is.na(tips.df[,'sample.philippines']),'sample.philippines'] <- FALSE#
#
### Add column with the biogeographic realms that the species occurs in#
rangesmat      <- do.call(rbind,lapply(strsplit(readLines(rangespath),split='\t'),function(x){x[2:3]}))#
rangesmat      <- rangesmat[!is.na(rangesmat[,1]),]#
rangesmat[,1]  <- gsub(" ","-",rangesmat[,1])#
rangesmat[,2]  <- gsub('Afrotropics/Seychelles','Afrotropics',gsub('Americas/Caribbean','Americas',rangesmat[,2]))#
rangesmat[,2]  <- gsub(',','',sapply(strsplit(rangesmat[,2],split=' '),function(x){paste(sort(x),collapse=' ')}))#
# sort(unique(rangesmat[,2]))#
tips.df[,'species.biogeog'] <- rangesmat[match(tips.df[,'species'],rangesmat[,1]),2]#
#
### Add column with the biogeographic realms that the genus occurs in...#
#
## Add a column (geog1) with biogeographic realms of species for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#tips.df[,'geog1'] <- NA#
tips.df[tips.df[,'sample.philippines']==TRUE,'geog1']   <- 'Philippines'#
tips.df[tips.df[,'species.philippines']==FALSE,'geog1'] <- tips.df[tips.df[,'species.philippines']==FALSE,'species.biogeog']#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Australia|SolomonIslands|NewGuinea',tips.df[,'locality']), 'geog1'] <- 'Oceanea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Java|Borneo|Sumatra|Malaysia|Nias-Indonesia',tips.df[,'locality']), 'geog1'] <- 'Sundaland'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Selayar|Sulawesi|Sumbawa',tips.df[,'locality']), 'geog1'] <- 'Wallacea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Thailand|Cambodia|Laos|Vietnam|Guangdong-China|Guangxi-China|Ayeyarwady-Myanmar|Yunan-China',tips.df[,'locality']), 'geog1'] <- 'Indochina'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('BitarKanika-Odisha-India',tips.df[,'locality']), 'geog1'] <- 'IndianSC'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('UnknownLocality',tips.df[,'locality']), 'geog1'] <- NA#
#
# Add a column (geog2) with biogeographic realms of genus for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#
#############
# unique(tips.df[tips.df[,'sample.philippines']==T,'locality'])#
# Add columns for presense/absence in Philippine PAICs#
tips.df[grep('Mindoro-',tips.df[,'locality']),'sample.Mindoro'] <- TRUE#
tips.df[grep('Guimaras-|Panay-|Negros-|Cebu-|Masbate-',tips.df[,'locality']),'sample.WestVisayas'] <- TRUE#
tips.df[grep('Palawan-',tips.df[,'locality']),'sample.Palawan'] <- TRUE
checklist.df <- read.table(checklistpath, header=F,col.names=c("taxon","islands"),sep='\t')
head(checklist.df)
treepath      <- "/Users/jeff/Documents/AllSnakes_Sanger/timetree_thinned_2chains_B10_MCC.nex"#
# file with names of all Philippine snake taxa, one name per line. Names should have at most three parts.#
checklistpath <- "/Users/jeff/Documents/AllSnakes_Sanger/allsnakes_species_philippines.txt"#
# file with names of all species recognized by Reptile Database#
taxonomypath  <- "/Users/jeff/Documents/AllSnakes_Sanger/RDB_taxonomy.txt"#
# file with RDB distributions for species sampled#
rangespath <- '/Users/jeff/Documents/RDB_Distributions_Snakes_sampled.txt'#
# file with tip labels in clades that are fossil calibrated (one row per clade)#
calibrationspath <- '/Users/jeff/Documents/AllSnakes_Sanger/fossilcalibrations.txt'#
#
### load nexus file generated by iqtree#
#timetree  <- treeio::read.beast("/Users/jeff/Documents/AllSnakes_Sanger/timetree4.timetree.nex")#
# timetree <- ape::read.nexus("/panfs/pfs.local/home/j926w878/scratch/scratch_v4/AllSnakes/simmap/timetree4.timetree.nex")#
timetree <- ape::read.nexus(treepath)#
#timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444",grep('Lycodon-capucinus|Indotyphlops-braminus',timetree$tip.label,value=TRUE)))#
timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444"))#
#
### If tips are shortnames, then load the file that maps the long names (with taxa and localities) to the short names (sample1, sample2, ...)#
# tips.df <- read.table("/Users/jeff/Documents/AllSnakes_Sanger/timetree4_shortnames_longnames2.txt", header=F,col.names=c("label","label2"))#
#
### If tip names already include taxon and locality info, then start a dataframe with a 'label' column holding the tip labels, and with a label2 column that can be identical to the label column or different if you need to map name changes to the tips#
tips.df <- data.frame(label=timetree$tip.label, label2=timetree$tip.label)#
#
#### Updating labels.#
# If some names in the 'label' column are in the incorrect format, then indicate corrected name in the 'label2' column.#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_NoBands_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-bitorques-BandedNeck_','Calamaria-bitorques_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade3-SpNov_','Calamaria-gervaisii3_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-andersoni-SYS-r001699','Calamaria-andersoni_SYS-r001699',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-1_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-2_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Oxyrhabdium-cf-modestum_','Oxyrhabdium-modestum2_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-christyi_','Polemon-christyi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-robustus_','Polemon-robustus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aparallactus-cf-capensis_','Aparallactus-capensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-cf-marenae_','Dendrelaphis-marenae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-cf-mcnamarae_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Raclitia-cf-indica_','Raclitia-indica_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tropidolaemus-cf-philippensis_','Tropidolaemus-philippensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Acrantophis-cf-dumerili_','Acrantophis-dumerili_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-cf-olivaceus_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerrhopilus-cf-hedraeus_','Gerrhopilus-hedraeus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sibynophis-geminatus-geminatus_','Sibynophis-geminatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Adelphicos-quadrivirgatus','Adelphicos-quadrivirgatum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhinotyphlops-schlegelii-mucruso_','Afrotyphlops-mucruso_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ahaetulla-fonticincta','Ahaetulla-fronticincta',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aspidomorphus-schlegeli_','Aspidomorphus-schlegelii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Atropoides-nummifer_','Metlapilcoatlus-nummifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-bilineata_','Calliophis-bilineatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-philippina_','Calliophis-philippinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Corallus-hortulanus_','Corallus-hortulana_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-caudolineatus-effrenis_','Dendrelaphis-effrenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-proarchos_','Dendrelaphis-pictus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dipsas-turgidus_','Dipsas-turgida_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Epicrates-angulifer_','Chilabothrus-angulifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Erythrolamprus-problematicus_','Arcanumophis-problematicus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Eryx-tataricus_','Eryx-miliaris_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gloydius-brevicaudus_','Gloydius-brevicauda_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gonionotophis-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Grayia-smythii','Grayia-smithii',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-khasiense_','Hebius-khasiensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-modestum_','Hebius-modestus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hierophis-caspius_','Dolichophis-caspius_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-mcdowelli_','Hydrophis-macdowelli_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Liopeltis-frenatus_','Liopeltis-frenata_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodonomorphus-laevessimus_','Lycodonomorphus-laevissimus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-effraensis_','Lycodon-effraenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-namdongensis_','Lycodon-chapaensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodryas-sanctijohannis_','Lycodryas-maculatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrovipera-lebetina_','Macrovipera-lebetinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Mehelya-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micrelaps-cf-muelleri_','Micrelaps-muelleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micropechis-ikaheka_','Micropechis-ikaheca_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Myriopholis-macrorhynchus_','Myriopholis-macrorhyncha_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Notechis-ater','Notechis-scutatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Philodryas-argentea_','Xenoxybelis-argenteus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Phimophis-iglesiasi_','Rodriguesophis-iglesiasi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pituophis-catenifer-vertebralis_','Pituophis-vertebralis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-notatum_','Polemon-notatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ptyas-multicinctus_','Ptyas-multicincta_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-sp_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-helleri_','Rhabdophis-helleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhagerhis-moilensis_','Malpolon-moilensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thamnophis-sauritus_','Thamnophis-saurita_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thrasops-jacksoni_','Thrasops-jacksonii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tricheilostoma-macrolepis_','Trilepida-macrolepis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Trimerodytes-balteata_','Trimerodytes-balteatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Typhlops-platycephalus_','Antillotyphlops-platycephalus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-sp_','Lycodon-alcalai_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-spNov-Luzon1_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hemibungarus-mcclungii_','Hemibungarus-mcclungi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thelotornis-capensis-mossambicanus','Thelotornis-mossambicanus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Chilabothrus-monensis-granti','Chilabothrus-granti',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_SanLuis-Aurora_CMNH5802','Pseudorabdion-mcnamarae_SanLuis-Aurora_CMNH5802',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_Siquijor_KU331732','Pseudorabdion-talonuran_Siquijor_KU331732',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Telescopus-fallax-iberus','Telescopus-fallax',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Coluber-constrictor-mormon','Coluber-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Masticophis-flagellum-flagellum','Masticophis-flagellum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Leptodeira-annulata-annulata','Leptodeira-annulata',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Vipera-aspis-hugyi','Vipera-aspis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sanzinia-madagascariensis-madagascariensis','Sanzinia-madagascariensis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Boa-constrictor-occidentalis','Boa-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Candoia-superciliosa-crombiei','Candoia-superciliosa',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Elaphe-taeniura-grabowskyi','Elaphe-taeniura',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-subminiatus','Rhabdophis-subminiatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-tigrinus-tigrinus|Rhabdophis-tigrinus-lateralis|Rhabdophis-tigrinus-formosanus','Rhabdophis-tigrinus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Craspedocephalus-sp_CESS074','Craspedocephalus-travancoricus_Kerala-India_BNHS3595',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Emydocephalus-annulatus_MGEa3','Emydocephalus-annulatus_NorthernTerritory-Australia_MGEa3',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-stokesii_As008','Hydrophis-stokesii_AshmoreReef-Australia_As008',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-curtus_Lc002','Hydrophis-curtus_Yongala-Queensland-Australia_Lc002',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Indotyphlops-braminus_ZCMV4006','Indotyphlops-braminus_Madagascar_ZCMV4006',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerarda-prevostiana_ZRC2.346','Gerarda-prevostiana_UnknownLocality_ZRC2.346',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aplopeltura-boa_Malaysia_KIZ11963','Aplopeltura-boa_PeninsularMalaysia_KIZ11963',tips.df[,'label2'])#
#
# ZRC2.346 # #
# ZCMV4006 # Madagascar_ZCMV4006#
#
# tips.df[which(tips.df[,'locality']=='ZCMV4006'),]#
#
##############
# Australia ##
##############
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#
# Samples need to include origin country in label, except for Indonesian, Malaysia, and Philippines samples, which need to include island name. Other geographical information can also be present.#
##########
# You can check label2 formatting with by splitting names and checking how many fields were generated.#
# labels.parts <- strsplit(tips.df[,'label2'],split='_')#
# table(lengths(labels.parts))#
#
### Add columns to hold taxon identity information for each tip#
tips.df[,'taxon']   <- gsub("_.*","",tips.df[,'label2'])#
tips.df[,'genus']   <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){x[1]})#
tips.df[,'species'] <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# load table with names of species recognized by Reptile Database#
RDBtaxa.df <- read.table(taxonomypath,header=T,sep='\t')#
RDBtaxa.df[,'Species'] <- gsub(' ','-',RDBtaxa.df[,'Species'])#
RDBtaxa.df[,'Genus'] <- sapply(strsplit(RDBtaxa.df[,'Species'],split=' |-'),function(x){x[1]})#
### Load checklist of taxa that occur in the philippines#
# NOTE: ADDED Malayotyphlops-sp to checklist because need to ID specimens (Siquijor)!#
checklist.df <- read.table(checklistpath, header=F,col.names=c("taxon","islands"),sep='\t')#
#
# Check if any sampled taxa are not in RDB database or the Philippines checklist#
missing <- setdiff(tips.df[,'taxon'],c(RDBtaxa.df[,'Species'],checklist.df[,'taxon']))#
#
# taxon.parts <- strsplit(tips.df[,'taxon'],split='-')#
# table(lengths(taxon.parts))#
# grep('-cf-',tips.df[,'taxon'])#
# tips.df[grep('Argyrophis-sp',tips.df[,'label2']),]#
#
# tips.df[,'genus']   <- gsub("-.*","",tips.df[,'label2'])#
# tips.df[,'species'] <- gsub("_.*","",tips.df[,'label2'])#
#
### Load checklist of taxa that occur in the philippines#
# speciesPH  <- read.table(checklistpath, header=F,col.names="taxon")#
# checklist.df <- read.table(checklistpath, header=F,col.names="taxon")#
# add columns to checklist.df with genus and Genus-species names parsed from the taxon column#
checklist.df[,'genus']   <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){x[1]})#
checklist.df[,'species'] <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# Indicate if tip genus/species/individual occurs in the Philippines#
tips.df[,'genus.philippines']   <- (tips.df[,'genus'] %in% checklist.df[,'genus'])#
tips.df[,'species.philippines'] <- (tips.df[,'species'] %in% checklist.df[,'species'] | tips.df[,'species'] %in% checklist.df[,'taxon'])#
#
### initial locality strings inferred from tip labels#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
#
######################
## Updating Locality Strings#
patt='Adams-IlocosNorte';repl='Adams-IlocosNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='AgusanSur';repl='AgusanSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Alcoy-Cebu';repl='Alcoy-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Argao-Cebu';repl='Argao-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bacacay-Albay';repl='Bacacay-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Balangiga-Samar';repl='Balangiga-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Basco-BatanIsl';repl='Basco-BatanIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Baybay-Leyte'; repl='Baybay-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bilar-Bohol'; repl='Bilar-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bohol'; repl='Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='BrookesPoint-Palawan'; repl='BrookesPoint-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buenavista-Guimaras'; repl='Buenavista-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buhi-Bicol'; repl='Buhi-Bicol-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bulan-Sorsogon'; repl='Bulan-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burauen-Leyte'; repl='Burauen-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burdeos-Polillo'; repl='Burdeos-Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CalayanIsl'; repl='CalayanIsl-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Calinan-DavaoCity'; repl='Calinan-DavaoCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamarinesSur'; repl='CamarinesSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinNorte'; repl='CamiguinNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinSur'; repl='CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Catanduanes'; repl='Catanduanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Cebu'; repl='Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CentralJava'; repl='CentralProvince-Java-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dalupiri'; repl='Dalupiri-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dumagete-Negros'; repl='Dumagete-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='EstrellaFalls-Palawan'; repl='EstrellaFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity'; repl='GingoogCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity-MisamisOriental'; repl='GingoogCity-MisamisOriental-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Glan-Sarangani'; repl='Glan-Sarangani-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Cagayan'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Luzon'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Hilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='IlocosSur'; repl='IlocosSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irawan-Palawan'; repl='Irawan-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irosin-Sorsogon'; repl='Irosin-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Jordan-Guimaras'; repl='Jordan-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kalimantan-Borneo'; repl='Kalimantan-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Keningau-Sabah'; repl='Keningau-Sabah-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kiblawan-DavaoSur'; repl='Kiblawan-DavaoSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kolombangara-SolomonIslands'; repl='Kolombangara-SolomonIslands'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesNorte'; repl='Labo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesSur'; repl='Labo-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LakeTaal-Philippines'; repl='LakeTaal-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Langkawi-WestMalaysia'; repl='Langkawi-WestMalaysia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LaTrinidad-Benguet'; repl='LaTrinidad-Benguet-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Leyte'; repl='Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto-Dinagat'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LosBanos-Laguna'; repl='LosBanos-Laguna-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Lubang'; repl='Lubang-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Luzon'; repl='Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magdiwang-Sibuyan'; repl='Magdiwang-Sibuyan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga-Cagayan'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magsaysay-Mindoro'; repl='Magsaysay-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MainitFalls-Palawan'; repl='MainitFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Malinao-Albay'; repl='Malinao-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Mambajao-CamiguinSur'; repl='Mambajao-CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MariaAurora-Aurora'; repl='MariaAurora-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Marinduque'; repl='Marinduque-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Matingaram-Mindoro'; repl='Matingaram-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Moalboal-Cebu'; repl='Moalboal-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtBanahao'; repl='MtBanahao-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHuraw-Samar'; repl='MtHuraw-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtLabo-CamarinesNorte'; repl='MtLabo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Narra-Palawan'; repl='Narra-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NiasIsland'; repl='Nias-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NorthSulawesi'; repl='NorthProvince-Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Norzagaray-Bulacan'; repl='Norzagaray-Bulacan-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Palawan'; repl='Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Panay'; repl='Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Antique'; repl='Pandan-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Panay'; repl='Pandan-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Poblacion-CaluyaIsl'; repl='Poblacion-CaluyaIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Polillo'; repl='Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Presentacion-CamarinesSur'; repl='Presentacion-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoGalera-Mindoro'; repl='PuertoGalera-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrinc-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrincessa-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaViscaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaVizcaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Real-Quezon'; repl='Real-Quezon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom';repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom-AgusanDelNorte'; repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Rizal-Palawan'; repl='Rizal-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sablayan-Mindoro'; repl='Sablayan-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang-Batanes'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Samar'; repl='Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFran-AgusanSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFrancisco-AgusanDelSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanLuis-Aurora'; repl='SanLuis-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanMariano-Isabela'; repl='SanMariano-Isabela-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRafael-Samar'; repl='SanRafael-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Antique'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Panay'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SelayarIsland'; repl='SelayarIsland-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SierraBullones-Bohol'; repl='SierraBullones-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Silay-Negros'; repl='Silay-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sipacot-CamarinesSur'; repl='Sipacot-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Siquijor'; repl='Siquijor-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sogud-SouthernLeyte'; repl='Sogud-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sorsogon'; repl='Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sulawesi'; repl='Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SuluIsl'; repl='Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumatra'; repl='Sumatra-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumbawa'; repl='Sumbawa-LesserSunda-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tablas'; repl='Tablas-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-EasternSamar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-Samar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotabato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotobato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='TawiTawi'; repl='TawiTawi-Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Ternate-Cavite'; repl='Ternate-Cavite-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Bohol'; repl='Valencia-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Negros'; repl='Valencia-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasanonca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Mindanao'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PasonancaZamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga-Pasononca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
#
######################################################
# Updates locality column after making changes to label2#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
######################################################
#
### Add column indicating if the sample locality is in the Philippines#
locality.list <- strsplit(tips.df[,'locality'],split='-')#
tips.df[,'sample.philippines'] <- sapply(locality.list,function(x){any(x=='Philippines')})#
tips.df[is.na(tips.df[,'sample.philippines']),'sample.philippines'] <- FALSE#
#
### Add column with the biogeographic realms that the species occurs in#
rangesmat      <- do.call(rbind,lapply(strsplit(readLines(rangespath),split='\t'),function(x){x[2:3]}))#
rangesmat      <- rangesmat[!is.na(rangesmat[,1]),]#
rangesmat[,1]  <- gsub(" ","-",rangesmat[,1])#
rangesmat[,2]  <- gsub('Afrotropics/Seychelles','Afrotropics',gsub('Americas/Caribbean','Americas',rangesmat[,2]))#
rangesmat[,2]  <- gsub(',','',sapply(strsplit(rangesmat[,2],split=' '),function(x){paste(sort(x),collapse=' ')}))#
# sort(unique(rangesmat[,2]))#
tips.df[,'species.biogeog'] <- rangesmat[match(tips.df[,'species'],rangesmat[,1]),2]#
#
### Add column with the biogeographic realms that the genus occurs in...#
#
## Add a column (geog1) with biogeographic realms of species for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#tips.df[,'geog1'] <- NA#
tips.df[tips.df[,'sample.philippines']==TRUE,'geog1']   <- 'Philippines'#
tips.df[tips.df[,'species.philippines']==FALSE,'geog1'] <- tips.df[tips.df[,'species.philippines']==FALSE,'species.biogeog']#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Australia|SolomonIslands|NewGuinea',tips.df[,'locality']), 'geog1'] <- 'Oceanea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Java|Borneo|Sumatra|Malaysia|Nias-Indonesia',tips.df[,'locality']), 'geog1'] <- 'Sundaland'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Selayar|Sulawesi|Sumbawa',tips.df[,'locality']), 'geog1'] <- 'Wallacea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Thailand|Cambodia|Laos|Vietnam|Guangdong-China|Guangxi-China|Ayeyarwady-Myanmar|Yunan-China',tips.df[,'locality']), 'geog1'] <- 'Indochina'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('BitarKanika-Odisha-India',tips.df[,'locality']), 'geog1'] <- 'IndianSC'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('UnknownLocality',tips.df[,'locality']), 'geog1'] <- NA#
#
# Add a column (geog2) with biogeographic realms of genus for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#
#############
# unique(tips.df[tips.df[,'sample.philippines']==T,'locality'])#
# Add columns indicating if the sample is from a Philippine PAIC#
tips.df[grep('Mindoro-',tips.df[,'locality']),'sample.Mindoro'] <- TRUE#
tips.df[grep('Guimaras-|Panay-|Negros-|Cebu-|Masbate-',tips.df[,'locality']),'sample.WestVisayas'] <- TRUE#
tips.df[grep('Palawan-',tips.df[,'locality']),'sample.Palawan'] <- TRUE
head(tips.df)
tips.df[grep('Mindanao-|Dinagat-|Samar-|Bohol-|Leyte-|CamiguinSur',tips.df[,'locality']),'sample.Mindanao'] <- TRUE
head(tips.df)
tips.df[grep('Mindoro-',tips.df[,'locality']),'sample.Mindoro'] <- TRUE#
tips.df[grep('Guimaras-|Panay-|Negros-|Cebu-|Masbate-',tips.df[,'locality']),'sample.WestVisayas'] <- TRUE#
tips.df[grep('Palawan-',tips.df[,'locality']),'sample.Palawan'] <- TRUE#
tips.df[grep('Mindanao-|Dinagat-|Samar-|Bohol-|Leyte-|CamiguinSur-',tips.df[,'locality']),'sample.Mindanao'] <- TRUE#
tips.df[grep('Luzon-|Catanduanes-|Marinduque-|Polillo-',tips.df[,'locality']),'sample.Luzon'] <- TRUE#
tips.df[grep('Sulu-|TawiTawi-',tips.df[,'locality']),'sample.Sulu'] <- TRUE#
tips.df[grep('Romblon-|Sibuyan-|Tablas-',tips.df[,'locality']),'sample.RIG'] <- TRUE#
tips.df[grep('CaluyaIsl-|Caluya-',tips.df[,'locality']),'sample.Caluya'] <- TRUE#
tips.df[grep('Lubang-',tips.df[,'locality']),'sample.Lubang'] <- TRUE#
tips.df[grep('CamiguinNorte-|BabuyanIsl-|CalayanIsl-|Dalupiri-',tips.df[,'locality']),'sample.Babuyan'] <- TRUE#
tips.df[grep('Sabtang-|Batan-',tips.df[,'locality']),'sample.Batanes'] <- TRUE
head(tips.df)
treepath      <- "/Users/jeff/Documents/AllSnakes_Sanger/timetree_thinned_2chains_B10_MCC.nex"#
# file with names of all Philippine snake taxa, one name per line. Names should have at most three parts.#
checklistpath <- "/Users/jeff/Documents/AllSnakes_Sanger/allsnakes_species_philippines.txt"#
# file with names of all species recognized by Reptile Database#
taxonomypath  <- "/Users/jeff/Documents/AllSnakes_Sanger/RDB_taxonomy.txt"#
# file with RDB distributions for species sampled#
rangespath <- '/Users/jeff/Documents/RDB_Distributions_Snakes_sampled.txt'#
# file with tip labels in clades that are fossil calibrated (one row per clade)#
calibrationspath <- '/Users/jeff/Documents/AllSnakes_Sanger/fossilcalibrations.txt'#
#
### load nexus file generated by iqtree#
#timetree  <- treeio::read.beast("/Users/jeff/Documents/AllSnakes_Sanger/timetree4.timetree.nex")#
# timetree <- ape::read.nexus("/panfs/pfs.local/home/j926w878/scratch/scratch_v4/AllSnakes/simmap/timetree4.timetree.nex")#
timetree <- ape::read.nexus(treepath)#
#timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444",grep('Lycodon-capucinus|Indotyphlops-braminus',timetree$tip.label,value=TRUE)))#
timetree <- ape::drop.tip(timetree,c("Boiga-cynodon_Palawan_KU311444"))#
#
### If tips are shortnames, then load the file that maps the long names (with taxa and localities) to the short names (sample1, sample2, ...)#
# tips.df <- read.table("/Users/jeff/Documents/AllSnakes_Sanger/timetree4_shortnames_longnames2.txt", header=F,col.names=c("label","label2"))#
#
### If tip names already include taxon and locality info, then start a dataframe with a 'label' column holding the tip labels, and with a label2 column that can be identical to the label column or different if you need to map name changes to the tips#
tips.df <- data.frame(label=timetree$tip.label, label2=timetree$tip.label)#
#
#### Updating labels.#
# If some names in the 'label' column are in the incorrect format, then indicate corrected name in the 'label2' column.#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_NoBands_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-bitorques-BandedNeck_','Calamaria-bitorques_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade3-SpNov_','Calamaria-gervaisii3_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-cf-gervaisii-Clade4-SpNov_','Calamaria-gervaisii4_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calamaria-andersoni-SYS-r001699','Calamaria-andersoni_SYS-r001699',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-1_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrocalamus-cf-chanardi-2_','Macrocalamus-chanardi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Oxyrhabdium-cf-modestum_','Oxyrhabdium-modestum2_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-christyi_','Polemon-christyi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-cf-robustus_','Polemon-robustus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aparallactus-cf-capensis_','Aparallactus-capensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-cf-marenae_','Dendrelaphis-marenae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-cf-mcnamarae_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Raclitia-cf-indica_','Raclitia-indica_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tropidolaemus-cf-philippensis_','Tropidolaemus-philippensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Acrantophis-cf-dumerili_','Acrantophis-dumerili_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-cf-olivaceus_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerrhopilus-cf-hedraeus_','Gerrhopilus-hedraeus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sibynophis-geminatus-geminatus_','Sibynophis-geminatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Adelphicos-quadrivirgatus','Adelphicos-quadrivirgatum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhinotyphlops-schlegelii-mucruso_','Afrotyphlops-mucruso_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ahaetulla-fonticincta','Ahaetulla-fronticincta',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aspidomorphus-schlegeli_','Aspidomorphus-schlegelii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Atropoides-nummifer_','Metlapilcoatlus-nummifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-bilineata_','Calliophis-bilineatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Calliophis-philippina_','Calliophis-philippinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Corallus-hortulanus_','Corallus-hortulana_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-caudolineatus-effrenis_','Dendrelaphis-effrenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dendrelaphis-proarchos_','Dendrelaphis-pictus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Dipsas-turgidus_','Dipsas-turgida_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Epicrates-angulifer_','Chilabothrus-angulifer_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Erythrolamprus-problematicus_','Arcanumophis-problematicus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Eryx-tataricus_','Eryx-miliaris_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gloydius-brevicaudus_','Gloydius-brevicauda_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gonionotophis-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Grayia-smythii','Grayia-smithii',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-khasiense_','Hebius-khasiensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hebius-modestum_','Hebius-modestus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hierophis-caspius_','Dolichophis-caspius_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-mcdowelli_','Hydrophis-macdowelli_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Liopeltis-frenatus_','Liopeltis-frenata_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodonomorphus-laevessimus_','Lycodonomorphus-laevissimus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-effraensis_','Lycodon-effraenis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-namdongensis_','Lycodon-chapaensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodryas-sanctijohannis_','Lycodryas-maculatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Macrovipera-lebetina_','Macrovipera-lebetinus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Mehelya-nyassae_','Gracililima-nyassae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micrelaps-cf-muelleri_','Micrelaps-muelleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Micropechis-ikaheka_','Micropechis-ikaheca_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Myriopholis-macrorhynchus_','Myriopholis-macrorhyncha_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Notechis-ater','Notechis-scutatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Philodryas-argentea_','Xenoxybelis-argenteus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Phimophis-iglesiasi_','Rodriguesophis-iglesiasi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pituophis-catenifer-vertebralis_','Pituophis-vertebralis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Polemon-notatum_','Polemon-notatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ptyas-multicinctus_','Ptyas-multicincta_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Ramphotyphlops-sp_','Ramphotyphlops-olivaceus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-helleri_','Rhabdophis-helleri_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhagerhis-moilensis_','Malpolon-moilensis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thamnophis-sauritus_','Thamnophis-saurita_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thrasops-jacksoni_','Thrasops-jacksonii_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Tricheilostoma-macrolepis_','Trilepida-macrolepis_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Trimerodytes-balteata_','Trimerodytes-balteatus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Typhlops-platycephalus_','Antillotyphlops-platycephalus_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Lycodon-sp_','Lycodon-alcalai_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-spNov-Luzon1_','Pseudorabdion-mcnamarae_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hemibungarus-mcclungii_','Hemibungarus-mcclungi_',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Thelotornis-capensis-mossambicanus','Thelotornis-mossambicanus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Chilabothrus-monensis-granti','Chilabothrus-granti',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_SanLuis-Aurora_CMNH5802','Pseudorabdion-mcnamarae_SanLuis-Aurora_CMNH5802',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Pseudorabdion-sp_Siquijor_KU331732','Pseudorabdion-talonuran_Siquijor_KU331732',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Telescopus-fallax-iberus','Telescopus-fallax',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Coluber-constrictor-mormon','Coluber-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Masticophis-flagellum-flagellum','Masticophis-flagellum',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Leptodeira-annulata-annulata','Leptodeira-annulata',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Vipera-aspis-hugyi','Vipera-aspis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Sanzinia-madagascariensis-madagascariensis','Sanzinia-madagascariensis',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Boa-constrictor-occidentalis','Boa-constrictor',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Candoia-superciliosa-crombiei','Candoia-superciliosa',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Elaphe-taeniura-grabowskyi','Elaphe-taeniura',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-subminiatus-subminiatus','Rhabdophis-subminiatus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Rhabdophis-tigrinus-tigrinus|Rhabdophis-tigrinus-lateralis|Rhabdophis-tigrinus-formosanus','Rhabdophis-tigrinus',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Craspedocephalus-sp_CESS074','Craspedocephalus-travancoricus_Kerala-India_BNHS3595',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Emydocephalus-annulatus_MGEa3','Emydocephalus-annulatus_NorthernTerritory-Australia_MGEa3',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-stokesii_As008','Hydrophis-stokesii_AshmoreReef-Australia_As008',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Hydrophis-curtus_Lc002','Hydrophis-curtus_Yongala-Queensland-Australia_Lc002',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Indotyphlops-braminus_ZCMV4006','Indotyphlops-braminus_Madagascar_ZCMV4006',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Gerarda-prevostiana_ZRC2.346','Gerarda-prevostiana_UnknownLocality_ZRC2.346',tips.df[,'label2'])#
tips.df[,'label2'] <- gsub('Aplopeltura-boa_Malaysia_KIZ11963','Aplopeltura-boa_PeninsularMalaysia_KIZ11963',tips.df[,'label2'])#
#
# ZRC2.346 # #
# ZCMV4006 # Madagascar_ZCMV4006#
#
# tips.df[which(tips.df[,'locality']=='ZCMV4006'),]#
#
##############
# Australia ##
##############
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#tips.df[,'label2'] <- gsub('','',tips.df[,'label2'])#
#
# Samples need to include origin country in label, except for Indonesian, Malaysia, and Philippines samples, which need to include island name. Other geographical information can also be present.#
##########
# You can check label2 formatting with by splitting names and checking how many fields were generated.#
# labels.parts <- strsplit(tips.df[,'label2'],split='_')#
# table(lengths(labels.parts))#
#
### Add columns to hold taxon identity information for each tip#
tips.df[,'taxon']   <- gsub("_.*","",tips.df[,'label2'])#
tips.df[,'genus']   <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){x[1]})#
tips.df[,'species'] <- sapply(strsplit(tips.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# load table with names of species recognized by Reptile Database#
RDBtaxa.df <- read.table(taxonomypath,header=T,sep='\t')#
RDBtaxa.df[,'Species'] <- gsub(' ','-',RDBtaxa.df[,'Species'])#
RDBtaxa.df[,'Genus'] <- sapply(strsplit(RDBtaxa.df[,'Species'],split=' |-'),function(x){x[1]})#
### Load checklist of taxa that occur in the philippines#
# NOTE: ADDED Malayotyphlops-sp to checklist because need to ID specimens (Siquijor)!#
checklist.df <- read.table(checklistpath, header=F,col.names=c("taxon","islands"),sep='\t')#
#
# Check if any sampled taxa are not in RDB database or the Philippines checklist#
missing <- setdiff(tips.df[,'taxon'],c(RDBtaxa.df[,'Species'],checklist.df[,'taxon']))#
#
# taxon.parts <- strsplit(tips.df[,'taxon'],split='-')#
# table(lengths(taxon.parts))#
# grep('-cf-',tips.df[,'taxon'])#
# tips.df[grep('Argyrophis-sp',tips.df[,'label2']),]#
#
# tips.df[,'genus']   <- gsub("-.*","",tips.df[,'label2'])#
# tips.df[,'species'] <- gsub("_.*","",tips.df[,'label2'])#
#
### Load checklist of taxa that occur in the philippines#
# speciesPH  <- read.table(checklistpath, header=F,col.names="taxon")#
# checklist.df <- read.table(checklistpath, header=F,col.names="taxon")#
# add columns to checklist.df with genus and Genus-species names parsed from the taxon column#
checklist.df[,'genus']   <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){x[1]})#
checklist.df[,'species'] <- sapply(strsplit(checklist.df[,'taxon'],split=' |-'),function(x){paste(x[1:2], collapse='-')})#
#
# Indicate if tip genus/species/individual occurs in the Philippines#
tips.df[,'genus.philippines']   <- (tips.df[,'genus'] %in% checklist.df[,'genus'])#
tips.df[,'species.philippines'] <- (tips.df[,'species'] %in% checklist.df[,'species'] | tips.df[,'species'] %in% checklist.df[,'taxon'])#
#
### initial locality strings inferred from tip labels#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
#
######################
## Updating Locality Strings#
patt='Adams-IlocosNorte';repl='Adams-IlocosNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='AgusanSur';repl='AgusanSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Alcoy-Cebu';repl='Alcoy-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Argao-Cebu';repl='Argao-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bacacay-Albay';repl='Bacacay-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Balangiga-Samar';repl='Balangiga-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Basco-BatanIsl';repl='Basco-BatanIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Baybay-Leyte'; repl='Baybay-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bilar-Bohol'; repl='Bilar-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bohol'; repl='Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='BrookesPoint-Palawan'; repl='BrookesPoint-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buenavista-Guimaras'; repl='Buenavista-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Buhi-Bicol'; repl='Buhi-Bicol-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Bulan-Sorsogon'; repl='Bulan-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burauen-Leyte'; repl='Burauen-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Burdeos-Polillo'; repl='Burdeos-Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CalayanIsl'; repl='CalayanIsl-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Calinan-DavaoCity'; repl='Calinan-DavaoCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamarinesSur'; repl='CamarinesSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinNorte'; repl='CamiguinNorte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CamiguinSur'; repl='CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Catanduanes'; repl='Catanduanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Cebu'; repl='Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='CentralJava'; repl='CentralProvince-Java-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dalupiri'; repl='Dalupiri-Calayan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Dumagete-Negros'; repl='Dumagete-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='EstrellaFalls-Palawan'; repl='EstrellaFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity'; repl='GingoogCity-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='GingoogCity-MisamisOriental'; repl='GingoogCity-MisamisOriental-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Glan-Sarangani'; repl='Glan-Sarangani-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Cagayan'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Gonzaga-Luzon'; repl='Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Hilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='IlocosSur'; repl='IlocosSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irawan-Palawan'; repl='Irawan-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Irosin-Sorsogon'; repl='Irosin-Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Jordan-Guimaras'; repl='Jordan-Guimaras-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kalimantan-Borneo'; repl='Kalimantan-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Keningau-Sabah'; repl='Keningau-Sabah-Borneo'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kiblawan-DavaoSur'; repl='Kiblawan-DavaoSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Kolombangara-SolomonIslands'; repl='Kolombangara-SolomonIslands'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesNorte'; repl='Labo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Labo-CamarinesSur'; repl='Labo-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LakeTaal-Philippines'; repl='LakeTaal-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Langkawi-WestMalaysia'; repl='Langkawi-WestMalaysia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LaTrinidad-Benguet'; repl='LaTrinidad-Benguet-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Leyte'; repl='Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Loreto-Dinagat'; repl='Loreto-Dinagat-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='LosBanos-Laguna'; repl='LosBanos-Laguna-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Lubang'; repl='Lubang-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Luzon'; repl='Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magdiwang-Sibuyan'; repl='Magdiwang-Sibuyan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magrafil-Gonzaga-Cagayan'; repl='Magrafil-Gonzaga-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Magsaysay-Mindoro'; repl='Magsaysay-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MainitFalls-Palawan'; repl='MainitFalls-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Malinao-Albay'; repl='Malinao-Albay-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Mambajao-CamiguinSur'; repl='Mambajao-CamiguinSur-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MariaAurora-Aurora'; repl='MariaAurora-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Marinduque'; repl='Marinduque-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Matingaram-Mindoro'; repl='Matingaram-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Moalboal-Cebu'; repl='Moalboal-Cebu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtBanahao'; repl='MtBanahao-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHilong-Hilong'; repl='HilongHilong-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtHuraw-Samar'; repl='MtHuraw-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='MtLabo-CamarinesNorte'; repl='MtLabo-CamarinesNorte-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Narra-Palawan'; repl='Narra-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NiasIsland'; repl='Nias-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='NorthSulawesi'; repl='NorthProvince-Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Norzagaray-Bulacan'; repl='Norzagaray-Bulacan-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Palawan'; repl='Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Panay'; repl='Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Antique'; repl='Pandan-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pandan-Panay'; repl='Pandan-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Poblacion-CaluyaIsl'; repl='Poblacion-CaluyaIsl-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Polillo'; repl='Polillo-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Presentacion-CamarinesSur'; repl='Presentacion-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoGalera-Mindoro'; repl='PuertoGalera-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrinc-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PuertoPrincessa-Palawan'; repl='PuertoPrincessa-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaViscaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Quezon-NuevaVizcaya'; repl='Quezon-NuevaVizcaya-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Real-Quezon'; repl='Real-Quezon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom';repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='RemTRom-AgusanDelNorte'; repl='RemTRom-AgusanDelNorte-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Rizal-Palawan'; repl='Rizal-Palawan-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sablayan-Mindoro'; repl='Sablayan-Mindoro-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sabtang-Batanes'; repl='Sabtang-Batanes-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Samar'; repl='Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFran-AgusanSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanFrancisco-AgusanDelSur'; repl='SanFrancisco-AgusanDelSur-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanLuis-Aurora'; repl='SanLuis-Aurora-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanMariano-Isabela'; repl='SanMariano-Isabela-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRafael-Samar'; repl='SanRafael-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Antique'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SanRemigio-Panay'; repl='SanRemigio-Antique-Panay-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SelayarIsland'; repl='SelayarIsland-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SierraBullones-Bohol'; repl='SierraBullones-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Silay-Negros'; repl='Silay-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sipacot-CamarinesSur'; repl='Sipacot-CamarinesSur-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Siquijor'; repl='Siquijor-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sogud-SouthernLeyte'; repl='Sogud-Leyte-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sorsogon'; repl='Sorsogon-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sulawesi'; repl='Sulawesi'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='SuluIsl'; repl='Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumatra'; repl='Sumatra-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Sumbawa'; repl='Sumbawa-LesserSunda-Indonesia'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tablas'; repl='Tablas-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-EasternSamar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Taft-Samar'; repl='Taft-Samar-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotabato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Tampakan-SouthCotobato'; repl='Tampakan-SouthCotabato-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='TawiTawi'; repl='TawiTawi-Sulu-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Ternate-Cavite'; repl='Ternate-Cavite-Luzon-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Bohol'; repl='Valencia-Bohol-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Valencia-Negros'; repl='Valencia-Negros-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasanonca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Mindanao'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Pasonanca-ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='PasonancaZamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='Zamboanga-Pasononca'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
patt='ZamboangaCity'; repl='Pasonanca-Zamboanga-Mindanao-Philippines'; tips.df[which(tips.df[,'locality']==patt),'label2'] <- gsub(patt,repl,tips.df[which(tips.df[,'locality']==patt),'label2'])#
#
######################################################
# Updates locality column after making changes to label2#
tips.df[,'locality'] <- sapply(strsplit(tips.df[,'label2'],split='_'),function(x){x[2]})#
tips.df[!tips.df[,'species.philippines'],'locality'] <- NA#
######################################################
#
### Add column indicating if the sample locality is in the Philippines#
locality.list <- strsplit(tips.df[,'locality'],split='-')#
tips.df[,'sample.philippines'] <- sapply(locality.list,function(x){any(x=='Philippines')})#
tips.df[is.na(tips.df[,'sample.philippines']),'sample.philippines'] <- FALSE#
#
### Add column with the biogeographic realms that the species occurs in#
rangesmat      <- do.call(rbind,lapply(strsplit(readLines(rangespath),split='\t'),function(x){x[2:3]}))#
rangesmat      <- rangesmat[!is.na(rangesmat[,1]),]#
rangesmat[,1]  <- gsub(" ","-",rangesmat[,1])#
rangesmat[,2]  <- gsub('Afrotropics/Seychelles','Afrotropics',gsub('Americas/Caribbean','Americas',rangesmat[,2]))#
rangesmat[,2]  <- gsub(',','',sapply(strsplit(rangesmat[,2],split=' '),function(x){paste(sort(x),collapse=' ')}))#
# sort(unique(rangesmat[,2]))#
tips.df[,'species.biogeog'] <- rangesmat[match(tips.df[,'species'],rangesmat[,1]),2]#
#
### Add column with the biogeographic realms that the genus occurs in...#
#
## Add a column (geog1) with biogeographic realms of species for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#tips.df[,'geog1'] <- NA#
tips.df[tips.df[,'sample.philippines']==TRUE,'geog1']   <- 'Philippines'#
tips.df[tips.df[,'species.philippines']==FALSE,'geog1'] <- tips.df[tips.df[,'species.philippines']==FALSE,'species.biogeog']#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Australia|SolomonIslands|NewGuinea',tips.df[,'locality']), 'geog1'] <- 'Oceanea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Java|Borneo|Sumatra|Malaysia|Nias-Indonesia',tips.df[,'locality']), 'geog1'] <- 'Sundaland'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Selayar|Sulawesi|Sumbawa',tips.df[,'locality']), 'geog1'] <- 'Wallacea'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('Thailand|Cambodia|Laos|Vietnam|Guangdong-China|Guangxi-China|Ayeyarwady-Myanmar|Yunan-China',tips.df[,'locality']), 'geog1'] <- 'Indochina'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('BitarKanika-Odisha-India',tips.df[,'locality']), 'geog1'] <- 'IndianSC'#
tips.df[(tips.df[,'species.philippines']==TRUE & tips.df[,'sample.philippines']==FALSE) & grepl('UnknownLocality',tips.df[,'locality']), 'geog1'] <- NA#
#
# Add a column (geog2) with biogeographic realms of genus for samples of species that only occur outside of the Philipples, biogeographic realm of sample locality for species that can occur in the Philippines#
#
#############
# unique(tips.df[tips.df[,'sample.philippines']==T,'locality'])#
#
## Add columns indicating if the sample is from a Philippine PAIC#
# initialize values as FALSE#
tips.df[,c('sample.Mindoro','sample.Palawan','sample.WestVisayas','sample.Mindanao','sample.Luzon','sample.Sulu','sample.RIG','sample.Caluya','sample.Lubang','sample.Babuyan','sample.Batanes')] <- FALSE
head(tips.df)
tips.df[grep('Mindoro-',tips.df[,'locality']),'sample.Mindoro'] <- TRUE#
tips.df[grep('Guimaras-|Panay-|Negros-|Cebu-|Masbate-',tips.df[,'locality']),'sample.WestVisayas'] <- TRUE#
tips.df[grep('Palawan-',tips.df[,'locality']),'sample.Palawan'] <- TRUE#
tips.df[grep('Mindanao-|Dinagat-|Samar-|Bohol-|Leyte-|CamiguinSur-',tips.df[,'locality']),'sample.Mindanao'] <- TRUE#
tips.df[grep('Luzon-|Catanduanes-|Marinduque-|Polillo-',tips.df[,'locality']),'sample.Luzon'] <- TRUE#
tips.df[grep('Sulu-|TawiTawi-',tips.df[,'locality']),'sample.Sulu'] <- TRUE#
tips.df[grep('Romblon-|Sibuyan-|Tablas-',tips.df[,'locality']),'sample.RIG'] <- TRUE#
tips.df[grep('CaluyaIsl-|Caluya-',tips.df[,'locality']),'sample.Caluya'] <- TRUE#
tips.df[grep('Lubang-',tips.df[,'locality']),'sample.Lubang'] <- TRUE#
tips.df[grep('CamiguinNorte-|BabuyanIsl-|CalayanIsl-|Dalupiri-',tips.df[,'locality']),'sample.Babuyan'] <- TRUE#
tips.df[grep('Sabtang-|Batan-',tips.df[,'locality']),'sample.Batanes'] <- TRUE
head(tips.df)
clades.list <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.Palawan']==T,'label'])
length(clades.list)
clades.list
tib
timetree2  <- treeio::read.beast(treepath)#
# Only keep tips that are in the timetree above#
timetree2  <- treeio::drop.tip(timetree2,setdiff(dplyr::select(timetree2,label)[!is.na(dplyr::select(timetree2,label))],timetree$tip.label))#
# tibble with node ages#
dates     <- attributes(timetree2)$data#
tib       <- tibble::as_tibble(timetree2)#
########################
## Philippine clades ###
########################
  # clades.list <- minCladesList(tree=timetree,tiplabs=intersect(geog.sample[['TRUE']],timetree$tip.label))#
  clades.list <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.philippines']==T,'label'])#
  # Ignore clades of marine species, and of recently introduced species; check to make sure that other taxa are not in the same group#
  clades.list <- clades.list[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list)]#
#
  # get age at each crown node of each clade#
  crownages_CI   <- lapply(clades.list,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(clades.list,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height'])})#
  tib            <- tibble::as_tibble(timetree2)#
  crown.nodes    <- unname(sapply(clades.list,function(x){MRCA(timetree2,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  #crownages_CI   <- do.call(c,(tib[match(crown.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  #crownages_mean <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
#
  ages.df <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)
# all nodes that belong to one of the Philippine clades#
  clades.allnodes <- unique(c(unlist(lapply(crown.nodes,function(x){Descendants(as.phylo(timetree2),node=x,type="all")})),crown.nodes))#
  col.df           <- data.frame(node=1:nrow(dates),color="gray")#
  col.df[col.df[,'node'] %in% clades.allnodes,'color'] <- 'black'
clades.list.palawan <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.Palawan']==T,'label'])#
  # Ignore clades of marine species, and of recently introduced species; check to make sure that other taxa are not in the same group#
  clades.list.palawan <- clades.list.palawan[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)]#
#
  # get age at each crown node of each clade#
  crownages_CI   <- lapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height'])})#
  crown.nodes    <- unname(sapply(clades.list.palawan,function(x){MRCA(timetree2,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  #crownages_CI   <- do.call(c,(tib[match(crown.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  #crownages_mean <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
#
  ages.df <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)#
#
  # all nodes that belong to one of the Palawan clades#
  clades.allnodes.palawan <- unique(c(unlist(lapply(crown.nodes,function(x){Descendants(as.phylo(timetree2),node=x,type="all")})),crown.nodes))#
  col.df[col.df[,'node'] %in% clades.allnodes.palawan,'color'] <- "#3B5BA9"#
#
  # read fossil calibrations data#
  calibrations     <- strsplit(gsub('.*= +|;','',readLines(calibrationspath)), split=' ')#
  nodes.calibrated <- sapply(calibrations,function(x){MRCA(timetree2,intersect(x,as.phylo(timetree2)$tip.label))})
head(ages.df)
dim(ages.df)
clades.list.palawan <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.Palawan']==T,'label'])#
  # Ignore clades of marine species, and of recently introduced species; check to make sure that other taxa are not in the same group#
  clades.list.palawan <- clades.list.palawan[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)]
crown.nodes    <- unname(sapply(clades.list.palawan,function(x){MRCA(timetree2,x)}))
crown.nodes
clades.list.palawan[[1]]
clades.list.palawan[1]
clades.list.palawan <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.Palawan']==T,'label'])
clades.list.palawan[1]
clades.list.palawan <- clades.list.palawan[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)]
clades.list.palawan[1]
grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)
grepl('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)
clades.list.palawan <- clades.list.palawan[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)]
grepl('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)
clades.list.palawan[1]
clades.list.palawan <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.Palawan']==T,'label'])
grepl('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)
clades.list.palawan <- clades.list.palawan[!grepl('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list.palawan)]
clades.list.palawan[1]
crown.nodes    <- unname(sapply(clades.list.palawan,function(x){MRCA(timetree2,x)}))
crown.nodes[1]
crown.nodes
stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)
stem.nodes
class(timetree2)
agesDF <- function(cladeslist,beastree)#
  dates          <- beastree@data#
  tib            <- tibble::as_tibble(beastree)#
  crown.nodes    <- unname(sapply(cladeslist,function(x){MRCA(beastree,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  crownages_CI   <- lapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height'])})#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  ages.df        <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)#
  ages.df#
}
agesDF <- function(cladeslist,beastree){#
  dates          <- beastree@data#
  tib            <- tibble::as_tibble(beastree)#
  crown.nodes    <- unname(sapply(cladeslist,function(x){MRCA(beastree,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  crownages_CI   <- lapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(clades.list.palawan,function(x){unlist(dates[which(dates[,'node']==MRCA(timetree2,x)),'height'])})#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  ages.df        <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)#
  ages.df#
}
clades.list <- minCladesList(tree=timetree,tiplabs=tips.df[tips.df[,'sample.philippines']==T,'label'])#
  # Ignore clades of marine species, and of recently introduced species; check to make sure that other taxa are not in the same group#
  clades.list <- clades.list[-grep('Acrochordus|Hydrophis|Laticauda|Indotyphlops|Lycodon-capucinus',clades.list)]
agesDF <- function(cladeslist,beastree){#
  dates          <- beastree@data#
  tib            <- tibble::as_tibble(beastree)#
  crown.nodes    <- unname(sapply(cladeslist,function(x){MRCA(beastree,x)}))#
  stem.nodes     <- unlist(tib[match(crown.nodes,unlist(tib[,'node'])),'parent'],use.names=FALSE)#
  crownages_CI   <- lapply(cladeslist,function(x){unlist(dates[which(dates[,'node']==MRCA(beastree,x)),'height_0.95_HPD'])})#
  crownages_mean <- sapply(cladeslist,function(x){unlist(dates[which(dates[,'node']==MRCA(beastree,x)),'height'])})#
  stemages_CI    <- do.call(c,(tib[match(stem.nodes,unlist(tib[,'node'])),'height_0.95_HPD']))#
  stemages_mean  <- unlist(tib[match(stem.nodes,unlist(tib[,'node'])),'height'],use.names=FALSE)#
  ages.df        <- data.frame(clade=1:length(crown.nodes),crown.node=crown.nodes,stem.node=stem.nodes,crown.age.mean=crownages_mean*(-1),stem.age.mean=stemages_mean*(-1))#
  ages.df[,'branch.age.midpoint'] <- rowMeans(cbind(crownages_mean,stemages_mean))*(-1)#
  ages.df[,'stem.age.CI.lower']   <- sapply(stemages_CI,function(x){min(x*(-1))})#
  ages.df[,'stem.age.CI.upper']   <- sapply(stemages_CI,function(x){max(x*(-1))})#
  ages.df[,'crown.age.CI.lower']  <- sapply(crownages_CI,function(x){min(x*(-1))})#
  ages.df[,'crown.age.CI.upper']  <- sapply(crownages_CI,function(x){max(x*(-1))})#
  ages.df[,'event.order']         <- rank(ages.df$branch.age.midpoint)#
  ages.df#
}
ages.df <- agesDF(clades.list,timetree2)
head(ages.df)
ages.df.palawan <- agesDF(clades.list.palawan,timetree2)
head(ages.df.palawan)
ages.df <- agesDF(clades.list,timetree2)#
  crown.nodes <- ages.df[,'crown.node']
clades.allnodes <- unique(c(unlist(lapply(crown.nodes,function(x){Descendants(as.phylo(timetree2),node=x,type="all")})),crown.nodes))
length(clades.allnodes)
lengths(clades.allnodes)
crown.nodes[1]
dim(ages.df)
length(crown.nodes <- ages.df[,'crown.node'])
length(crown.nodes)
dim(clades.allnodes)
crown.nodes[[1]]
col.df           <- data.frame(node=1:nrow(dates),color="gray")#
  col.df[col.df[,'node'] %in% clades.allnodes,'color'] <- 'black'#
#
  # read fossil calibrations data#
  calibrations     <- strsplit(gsub('.*= +|;','',readLines(calibrationspath)), split=' ')#
  nodes.calibrated <- sapply(calibrations,function(x){MRCA(timetree2,intersect(x,as.phylo(timetree2)$tip.label))})
tree1 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color)) + ggtree::geom_treescale(fontsize=4,offset=1,linesize=0.5,width=20,x=10,y=length(timetree2@phylo$tip.label)/2) + geom_nodelab(aes(subset = (node %in% nodes.calibrated), label = "*"), color = "black", size=4)#
  tree1
ages.df.palawan <- agesDF(clades.list.palawan,timetree2)
head(ages.df.palawan)
crown.nodes.palawan <- ages.df.palawan[,'crown.node']
crown.nodes.palawan
clades.allnodes.palawan <- unique(c(unlist(lapply(crown.nodes.palawan,function(x){Descendants(as.phylo(timetree2),node=x,type="all")})),crown.nodes.palawan))
length(clades.allnodes.palawan)
clades.allnodes.palawan
col.df[col.df[,'node'] %in% clades.allnodes.palawan,'color'] <- "#3B5BA9"
calibrations     <- strsplit(gsub('.*= +|;','',readLines(calibrationspath)), split=' ')#
  nodes.calibrated <- sapply(calibrations,function(x){MRCA(timetree2,intersect(x,as.phylo(timetree2)$tip.label))})
tree2 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color)) + ggtree::geom_treescale(fontsize=4,offset=1,linesize=0.5,width=20,x=10,y=length(timetree2@phylo$tip.label)/2) + geom_nodelab(aes(subset = (node %in% nodes.calibrated), label = "*"), color = "black", size=4)#
  tree2
tree2 + geom_text(x=0,y=0,label="test")
tree2 + geom_text(x=0,y=0,label="test",color="black")
tree2 + geom_text(x=0,y=0,label="test",color="black",size=4)
tree2 + geom_text(x=0,y=0,label="test",color="black",size=1)
tree2 + geom_text(x=0,y=0,label="test",color="black",size=5)
tree2 + geom_text(x=0,y=0,label="test",color="black",size=3.5)
tree2 + geom_text(x=10,y=length(timetree2@phylo$tip.label)/2),label="test",color="black",size=3.5)
length(timetree2@phylo$tip.label)/2)
length(timetree2@phylo$tip.label)/2
tree2 + geom_text(x=10,y=length(timetree2@phylo$tip.label)/2,label="test",color="black",size=3.5)
tree2 + geom_text(x=10,y=length(timetree2@phylo$tip.label)/2,label="test",color="black",size=3.5,nudge_y=10)
tree2 + geom_text(x=10,y=length(timetree2@phylo$tip.label)/2,label="test",color="black",size=3.5,nudge_y=50)
tree2 + geom_text(x=10,y=length(timetree2@phylo$tip.label)/2,label="test",color="black",size=3.5,check_overlap=T)
tree2 + geom_text(x=15,y=length(timetree2@phylo$tip.label)*0.55,label="test",color="black",size=3.5)
tree2 + geom_text(x=15,y=length(timetree2@phylo$tip.label)*0.51,label="test",color="black",size=3.5)
tree2 + geom_text(x=17,y=length(timetree2@phylo$tip.label)*0.53,label="test",color="black",size=3.5)
tree2 + geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="test",color="black",size=3.5)
tree2 + geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="20 Ma",color="black",size=3.5)
tree2 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color))
tree2
tree2 <- tree2 + ggtree::geom_treescale(fontsize=4,offset=1,linesize=0.5,width=20,x=10, y=length(timetree2@phylo$tip.label)/2)
tree2
tree2 <- tree2 + geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="20 Ma",color="black",size=3.5)
tree2
tree2 <- tree2 + ggtree::geom_treescale(fontsize=0,offset=0,linesize=0.5,width=20,x=10, y=length(timetree2@phylo$tip.label)/2)
tree2 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color))#
  tree2 <- tree2 + ggtree::geom_treescale(fontsize=0,offset=0,linesize=0.5,width=20,x=10, y=length(timetree2@phylo$tip.label)/2)
tree2
tree2 <- tree2 + geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="20 Ma",color="black",size=3.5)
tree2
tree2 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color))#
  # add time scale#
  tree2 <- tree2 + ggtree::geom_treescale(fontsize=0,offset=0,linesize=0.5,width=20,x=10, y=length(timetree2@phylo$tip.label)/2)#
  # add label for time scale#
  tree2 <- tree2 + geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="20 Ma",color="black",size=3.5)#
  # add asterisk at fossil calibrated nodes#
  tree2 <- tree2 + geom_nodelab(aes(subset = (node %in% nodes.calibrated), label = "*"), color = "black", size=4)#
  # graph the plot#
  tree2
?geom_nodelab
?geom_text
tree2 <- ggtree(timetree2,layout = 'circular',size=0.3) %<+% col.df + aes(color=I(color))#
  # add time scale#
  tree2 <- tree2 + ggtree::geom_treescale(fontsize=0,offset=0,linesize=0.5,width=20,x=10, y=length(timetree2@phylo$tip.label)/2)#
  # add label for time scale#
  tree2 <- tree2 + ggplot2::geom_text(x=20,y=length(timetree2@phylo$tip.label)*0.53,label="20 Ma",color="black",size=3.5)
tree2
?I
?Descendants
?as.phylo
clades.allnodes.palawan <- unique(c(unlist(lapply(crown.nodes.palawan,function(x){phangorn::Descendants(timetree2@phylo,node=x,type="all")})),crown.nodes.palawan))
clades.allnodes.palawan
q("no")
